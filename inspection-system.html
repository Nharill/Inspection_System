<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Page Navigation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Format Display Styles */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        
        .format-display-container {
            font-family: sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
        }

        /* New wrapper to hold the two form containers side-by-side */
        .form-pages-wrapper {
            display: flex;
            gap: 20px; /* Space between the two "pages" */
            justify-content: center;
            align-items: flex-start;
            flex-wrap: wrap; /* Allow wrapping on smaller screens if needed */
        }

        /* Container for each form copy, mimicking an A4 page */
        .form-container {
            background-color: #fff;
            border: 1px solid #000; /* Ensured 1px thickness */
            padding: 25px 30px; /* Adjusted padding to match document spacing */
            width: 8.5in; /* Standard A4 width, fixed for print-like accuracy */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            box-sizing: border-box; /* Ensure padding is included in width */
            position: relative;
            font-family: 'Times New Roman', serif;
            font-size: 10pt;
            /* Removed margin-bottom as gap in wrapper handles spacing */
        }

        /* Header section containing logo, main text, and control info */
        .header-section {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px; /* Increased margin for better separation */
        }

        /* Styling for the PUP logo */
        .logo {
            width: 70px; /* Slightly adjusted size for better fit */
            height: auto;
            margin-right: 20px; /* Increased margin for spacing */
            flex-shrink: 0; /* Prevent shrinking */
            padding-top: 3px; /* Fine-tune vertical alignment with text */
        }

        /* Text content in the header (Republic of the Philippines, etc.) */
        .header-text {
            flex-grow: 1;
            font-size: 0.6rem; /* Made smaller font size */
            line-height: 1.0; /* Tighter line height for compactness */
            padding-top: 5px; /* Align text with logo top */
            font-weight: bold; /* Made header text bolder */
        }
        .header-text p {
            margin: 0;
            padding: 0;
        }

        /* Control number and date information */
        .control-info {
            text-align: right;
            font-size: 0.55rem; /* Made smaller font for control info */
            line-height: 1.0; /* Tighter line height */
            margin-left: auto;
            padding-top: 5px; /* Align text with logo top */
            display: flex; /* Use flex to align control number with its line */
            flex-direction: column;
            justify-content: flex-start;
        }
        .control-info p {
            margin: 0;
            padding: 0;
        }
        .control-no-line {
            border-bottom: 1px solid #000; /* Ensured 1px thickness */
            min-height: 16px; /* Made slightly smaller */
            margin-top: 2px; /* Slight gap from "Rev 1" */
            width: 100%; /* Ensure it spans the width */
        }

        /* Main title for the request form */
        .form-title {
            font-weight: bold;
            font-size: 0.9rem;
            margin-top: 10px;
            margin-bottom: 15px; /* Increased margin */
            text-align: center;
            text-decoration: underline; /* Added underline as per image */
            padding-bottom: 3px;
        }

        /* Checkbox groups for types of inspection */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px; /* Increased margin */
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            font-size: 0.7rem;
            width: 50%; /* Two columns */
            margin-bottom: 8px; /* Spacing between checkbox items */
        }
        .checkbox-item input[type="checkbox"] {
            margin-right: 8px; /* Space between checkbox and label */
            transform: scale(0.9); /* Slightly larger checkbox */
            min-width: 14px; /* Ensure consistent checkbox size */
            min-height: 14px;
        }
        .checkbox-item label {
            line-height: 1.2;
        }

        /* Horizontal divider lines */
        .section-divider {
            border-bottom: 1px solid #000; /* Ensured 1px thickness */
            margin-bottom: 15px; /* Consistent margin */
        }

        /* Rows for input fields (Date, Requested by, etc.) */
        .input-row {
            display: flex;
            align-items: baseline; /* Align labels and fields */
            margin-bottom: 10px; /* Spacing between rows */
        }
        .input-label {
            font-size: 0.7rem;
            white-space: nowrap;
            margin-right: 10px; /* Space between label and field */
            flex-shrink: 0; /* Prevent label from shrinking */
            min-width: 150px; /* Fixed width for labels to align fields */
        }
        .input-field {
            width: 200px; /* Fixed width instead of flex-grow */
            border-bottom: 1px solid #000; /* Ensured 1px thickness */
            min-height: 18px; /* Ensure the line is visible */
            flex-shrink: 0; /* Prevent shrinking */
        }
        .input-row .ml-10 { /* Adjusted margin for second label in a row */
            margin-left: 20px; /* Reduced margin for better alignment */
            min-width: 150px; /* Fixed width for labels to align fields */
        }

        /* Documentary Requirements section */
        .documentary-requirements {
            margin-top: 15px;
            margin-bottom: 20px;
        }
        .documentary-requirements-title {
            font-size: 0.7rem;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .documentary-requirements-title span {
            font-style: italic; /* Italicize "To be filled-out by Inspectors" */
            font-weight: normal;
            margin-left: 20px; /* Space from the first part of the title */
        }
        .documentary-requirements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two equal columns */
            gap: 10px 20px; /* Vertical and horizontal gap */
        }
        .documentary-requirements-grid .checkbox-item {
            width: auto; /* Let grid handle width */
            margin-bottom: 0; /* No extra margin here */
        }
        .documentary-requirements-grid .checkbox-item .input-field {
            margin-left: 10px; /* Space for the "Others:" input */
            min-height: 16px; /* Slightly smaller line for "Others" */
        }

        /* --- New styles for the table and remarks section --- */
        .main-content-wrapper {
            display: flex;
            flex-direction: column; /* Stack sections vertically */
            gap: 20px; /* Space between the top and bottom sections */
            align-items: flex-start; /* Align all content to the left */
            width: 100%; /* Make it fill the form-container's content area */
            box-sizing: border-box;
        }
        .top-section {
            display: flex;
            flex-direction: row; /* Arrange remarks and first table side-by-side */
            gap: 30px; /* Space between remarks and first table */
            align-items: flex-start; /* Align them at the top */
            width: 100%; /* Ensure it spans the main-content-wrapper */
            box-sizing: border-box;
        }
        .remarks-legend {
            flex-shrink: 0; /* Prevent remarks from shrinking */
            width: 100px; /* Explicitly set width based on visual analysis */
            padding-top: 8px; /* Align with table header text */
        }
        .remarks-legend p {
            margin: 0;
            line-height: 1.5;
            font-size: 0.7rem; /* Ensure font size is consistent */
            display: flex; /* Use flexbox for alignment */
            align-items: baseline; /* Align text baselines */
        }
        .remarks-legend p b {
            display: inline-block; /* Make the bold part a block for width */
            width: 35px; /* Adjusted width to align "Complied" and "Not Complied" */
            text-align: left; /* Align the "C -" and "N.C -" to the left within their width */
            margin-right: 5px; /* Small gap between the bold part and italic part */
        }
        .remarks-legend i {
            font-style: italic;
            flex-grow: 1; /* Allow italic part to take remaining space */
        }

        /* Styling for the first table */
        .first-table-container {
            flex-grow: 1; /* Allow table to take remaining space */
            width: 580px; /* Fixed width for the first table */
            flex-shrink: 0;
        }
        .first-table-container table {
            border-collapse: collapse;
            width: 100%; /* Table fills its container */
            border: 1px solid black; /* Ensured 1px thickness */
        }
        .first-table-container th,
        .first-table-container td {
            border: 1px solid black; /* Ensured 1px thickness */
            padding: 6px; /* Slightly smaller padding */
            text-align: center;
            box-sizing: border-box;
        }
        .first-table-container th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 0.7rem;
            line-height: 1.2;
        }

        /* Specific widths for the first table columns */
        .first-table-container th:nth-child(1) { width: 180px; } /* Document In */
        .first-table-container th:nth-child(2) { width: 180px; } /* Document Out */
        .first-table-container th:nth-child(3) { width: 150px; } /* Remarks */
        .first-table-container th:nth-child(4) { width: 70px; }  /* C / N.C */

        .first-table-container td {
            height: 30px; /* Fixed height for rows */
            font-size: 0.7rem;
        }

        /* Styling for the new second table (bottom boxes) */
        .bottom-left-table-container {
            width: 300px; /* Fixed width for the bottom table */
            margin-left: 0; /* Align to the left */
            margin-right: auto; /* Push to the right to align with the left edge of the main wrapper */
        }
        .bottom-left-table-container table {
            border-collapse: collapse;
            width: 100%; /* Make the table fill its container */
            border: 1px solid black; /* Ensured 1px thickness */
        }
        .bottom-left-table-container td {
            border: 1px solid black; /* Ensured 1px thickness */
            height: 25px; /* Smaller height for rows */
            padding: 5px; /* Smaller padding */
            font-size: 0.7rem;
        }

        /* Copy labels (IMO COPY, SECOND COPY) */
        .copy-label {
            position: absolute;
            font-size: 1.1rem; /* Slightly smaller font */
            font-weight: bold;
            padding: 4px 8px; /* Adjusted padding */
            border-radius: 4px; /* Slightly smaller radius */
            font-family: Arial, sans-serif; /* Specific font for this label */
        }
        .imo-copy {
            color: #D32F2F; /* Red color */
            background-color: #FFCDD2; /* Light red background */
            border: 1px solid #D32F2F;
            top: 102px; /* Adjusted top position to align with Control No: line */
            right: 30px; /* Aligned with right padding */
        }
        .second-copy {
            color: #388E3C; /* Green color */
            background-color: #C8E6C9; /* Light green background */
            border: 1px solid #388E3C;
            top: 102px; /* Adjusted top position to align with Control No: line */
            right: 30px; /* Aligned with right padding */
        }

        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            
            body {
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                font-family: 'Times New Roman', serif !important;
                font-size: 10pt !important;
            }
            
            .format-display-container {
                background-color: white !important;
                margin: 0 !important;
                padding: 0 !important;
                min-height: auto !important;
                display: block !important;
                box-sizing: border-box !important;
            }
            
            .form-pages-wrapper {
                display: block !important;
                gap: 0 !important;
            }
            
            .form-container {
                page-break-after: always !important;
                margin: 0 auto 20px auto !important;
                box-shadow: none !important;
                border: 2px solid #000 !important;
                width: 8.5in !important;
                padding: 25px 30px !important;
                box-sizing: border-box !important;
                position: relative !important;
                background: white !important;
                display: block !important;
            }
            
            .form-container:last-child {
                page-break-after: auto !important;
                margin-bottom: 0 !important;
            }
            
            .copy-label {
                position: absolute !important;
                top: 102px !important;
                right: 30px !important;
                font-size: 14px !important;
                font-weight: bold !important;
                padding: 6px 12px !important;
                border-radius: 6px !important;
                border: 2px solid !important;
                font-family: Arial, sans-serif !important;
                display: block !important;
            }
            
            .imo-copy {
                color: #D32F2F !important;
                background-color: #FFEBEE !important;
                border-color: #D32F2F !important;
            }
            
            .second-copy {
                color: #388E3C !important;
                background-color: #E8F5E8 !important;
                border-color: #388E3C !important;
            }
            
            .header-section {
                display: flex !important;
                align-items: flex-start !important;
                margin-bottom: 15px !important;
            }
            
            .logo {
                width: 70px !important;
                height: auto !important;
                margin-right: 20px !important;
                flex-shrink: 0 !important;
                display: block !important;
            }
            
            .header-text {
                flex-grow: 1 !important;
                font-size: 11px !important;
                line-height: 1.1 !important;
                font-weight: bold !important;
                display: block !important;
            }
            
            .header-text p {
                margin: 0 !important;
                padding: 0 !important;
                display: block !important;
            }
            
            .control-info {
                text-align: right !important;
                font-size: 10px !important;
                line-height: 1.1 !important;
                display: flex !important;
                flex-direction: column !important;
            }
            
            .control-info p {
                margin: 0 !important;
                padding: 0 !important;
                display: block !important;
            }
            
            .control-no-line {
                border-bottom: 1px solid #000 !important;
                min-height: 18px !important;
                margin-top: 2px !important;
                width: 100% !important;
                display: inline-block !important;
                min-width: 120px !important;
                padding-bottom: 2px !important;
            }
            
            .form-title {
                font-weight: bold !important;
                font-size: 14px !important;
                margin: 10px 0 15px 0 !important;
                text-align: center !important;
                text-decoration: underline !important;
                display: block !important;
            }
            
            .checkbox-group {
                display: flex !important;
                flex-wrap: wrap !important;
                margin-bottom: 15px !important;
            }
            
            .checkbox-item {
                display: flex !important;
                align-items: center !important;
                font-size: 11px !important;
                width: 50% !important;
                margin-bottom: 8px !important;
            }
            
            .checkbox-item input[type="checkbox"] {
                margin-right: 8px !important;
                transform: scale(1.2) !important;
                display: inline-block !important;
            }
            
            .checkbox-item label {
                display: inline-block !important;
                line-height: 1.2 !important;
            }
            
            .section-divider {
                border-bottom: 1px solid #000 !important;
                margin-bottom: 15px !important;
                display: block !important;
            }
            
            .input-row {
                display: flex !important;
                align-items: baseline !important;
                margin-bottom: 10px !important;
            }
            
            .input-label {
                font-size: 11px !important;
                white-space: nowrap !important;
                margin-right: 10px !important;
                min-width: 150px !important;
                display: inline-block !important;
            }
            
            .input-field {
                border-bottom: 1px solid #000 !important;
                min-height: 18px !important;
                width: 200px !important;
                padding-bottom: 2px !important;
                font-size: 10px !important;
                display: inline-block !important;
            }
            
            .documentary-requirements {
                margin-top: 15px !important;
                margin-bottom: 20px !important;
                display: block !important;
            }
            
            .documentary-requirements-title {
                font-size: 11px !important;
                font-weight: bold !important;
                margin-bottom: 10px !important;
                display: flex !important;
                align-items: center !important;
            }
            
            .documentary-requirements-title span {
                font-style: italic !important;
                font-weight: normal !important;
                margin-left: 20px !important;
            }
            
            .documentary-requirements-grid {
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 10px 20px !important;
            }
            
            .documentary-requirements-grid .checkbox-item {
                width: auto !important;
                margin-bottom: 0 !important;
            }
            
            .main-content-wrapper {
                display: flex !important;
                flex-direction: column !important;
                gap: 20px !important;
            }
            
            .top-section {
                display: flex !important;
                gap: 30px !important;
            }
            
            .remarks-legend {
                width: 100px !important;
                font-size: 11px !important;
                flex-shrink: 0 !important;
            }
            
            .remarks-legend p {
                margin: 0 !important;
                line-height: 1.5 !important;
                display: flex !important;
                align-items: baseline !important;
            }
            
            .remarks-legend p b {
                display: inline-block !important;
                width: 35px !important;
                text-align: left !important;
                margin-right: 5px !important;
            }
            
            .remarks-legend i {
                font-style: italic !important;
                flex-grow: 1 !important;
            }
            
            .first-table-container {
                flex-grow: 1 !important;
                width: 580px !important;
            }
            
            .first-table-container table {
                border-collapse: collapse !important;
                width: 100% !important;
                border: 1px solid black !important;
                display: table !important;
            }
            
            .first-table-container th,
            .first-table-container td {
                border: 1px solid black !important;
                padding: 6px !important;
                text-align: center !important;
                font-size: 10px !important;
                display: table-cell !important;
            }
            
            .first-table-container th {
                background-color: #f2f2f2 !important;
                font-weight: bold !important;
            }
            
            .first-table-container td {
                height: 30px !important;
            }
            
            .bottom-left-table-container {
                width: 300px !important;
                margin-left: 0 !important;
            }
            
            .bottom-left-table-container table {
                border-collapse: collapse !important;
                width: 100% !important;
                border: 1px solid black !important;
                display: table !important;
            }
            
            .bottom-left-table-container td {
                border: 1px solid black !important;
                height: 25px !important;
                padding: 5px !important;
                font-size: 10px !important;
                display: table-cell !important;
            }
            
            .no-print {
                display: none !important;
            }
            
            /* Hide all other page content when printing forms */
            body > *:not(.format-display-container) {
                display: none !important;
            }
            
            /* Show only the format display container */
            .format-display-container {
                display: block !important;
                visibility: visible !important;
            }
            
            .format-display-container * {
                visibility: visible !important;
            }
        }
        
        @page {
            size: A4;
            margin: 0.5in;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-600 to-blue-600 min-h-screen font-sans">
    <!-- Page 1 -->
    <div id="page1" class="min-h-screen flex items-center justify-center p-8">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-lg w-full text-center">
            <div class="mb-8">
                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span class="text-4xl">üîí</span>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-4">Data Privacy Act Reminder</h1>
                <div class="bg-red-50 border border-red-200 rounded-lg p-6 mb-6 text-left">
                    <h3 class="font-semibold text-red-800 mb-3">‚ö†Ô∏è Republic Act No. 10173 - Data Privacy Act of 2012</h3>
                    <div class="text-sm text-gray-700 space-y-3">
                        <p><strong>Notice:</strong> This Inspection Request Form will collect the following personal information:</p>
                        <ul class="ml-4 space-y-1">
                            <li>‚Ä¢ Contact number and email addresses (personal & institutional)</li>
                            <li>‚Ä¢ Full name and office/department information</li>
                            <li>‚Ä¢ Disbursing officer details and sector information</li>
                            <li>‚Ä¢ Purchase details, purpose, and financial information</li>
                        </ul>
                        <p><strong>Your Rights:</strong> You have the right to be informed, access, rectify, erase, restrict processing, data portability, and object to processing of your personal data.</p>
                        <p><strong>Purpose:</strong> Data collected will be used solely for processing inspection requests and maintaining official records as required by institutional procedures.</p>
                        <p><strong>Storage:</strong> Information is stored securely and will be retained according to institutional record-keeping policies.</p>
                    </div>
                </div>
                <p class="text-gray-600 text-sm mb-6"><strong>Important:</strong> By proceeding, you consent to the collection and processing of your personal data as described above in accordance with the Data Privacy Act of 2012.</p>
            </div>
            
            <div class="space-y-4">
                <button 
                    onclick="disagreePrivacy()" 
                    class="bg-red-500 hover:bg-red-600 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl w-full">
                    ‚ùå Disagree & Exit
                </button>
                <button 
                    onclick="agreePrivacy()" 
                    class="bg-green-600 hover:bg-green-700 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl w-full">
                    ‚úÖ Agree & Continue
                </button>
            </div>
        </div>
    </div>

    <!-- Page 2 -->
    <div id="page2" class="min-h-screen flex items-center justify-center p-8 hidden overflow-y-auto">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-4xl w-full my-8">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span class="text-4xl">üìã</span>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-4">Inspection Request Form</h1>
            </div>
            
            <form id="inspectionForm" class="space-y-6">
                <!-- Purchase Type -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Purchase Type</h3>
                    <div class="space-y-4">
                        
                        <div class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="flex items-center space-x-3">
                                        <input type="radio" name="purchaseType" value="purchases" class="text-blue-600" onchange="toggleUCSSOptions()">
                                        <span>Operations Purchase</span>
                                    </label>
                                    <div id="ucssOptions" class="ml-8 mt-3 space-y-2 hidden">
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" name="ucssSubType" value="external" class="text-blue-600">
                                            <span>External</span>
                                        </label>
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" name="ucssSubType" value="internal" class="text-blue-600">
                                            <span>Internal</span>
                                        </label>
                                        <label class="flex items-center space-x-3">
                                            <input type="checkbox" name="ucssSubType" value="cashAdvance" class="text-blue-600">
                                            <span>Cash Advance</span>
                                        </label>
                                    </div>
                                </div>
                                <label class="flex items-center space-x-3">
                                    <input type="radio" name="purchaseType" value="ucss" class="text-blue-600" onchange="toggleUCSSOptions()">
                                    <span>UCSS Purchase</span>
                                </label>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <label class="flex items-center space-x-3">
                                    <input type="radio" name="purchaseType" value="postRepair" class="text-blue-600" onchange="toggleUCSSOptions()">
                                    <span>Post Repair/Waste Material</span>
                                </label>
                                <label class="flex items-center space-x-3">
                                    <input type="radio" name="purchaseType" value="janitorial" class="text-blue-600" onchange="toggleUCSSOptions()">
                                    <span>Janitorial Services</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Contact Number</label>
                        <input type="tel" id="contactNumber" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter contact number">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Personal Email</label>
                        <input type="email" id="personalEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter personal email">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Institutional Webmail</label>
                        <input type="email" id="institutionalEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter institutional email">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Requested By</label>
                        <input type="text" id="requestedBy" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter requester name">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Name of Disbursing Officer</label>
                        <input type="text" id="disbursingOfficer" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter disbursing officer name">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Office/Department</label>
                        <input type="text" id="officeDepartment" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter office and department">
                    </div>
                </div>

                <!-- Sector -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Sector</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="OP" class="text-blue-600">
                            <span>OP</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="OVPC" class="text-blue-600">
                            <span>OVPC</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="OVPred" class="text-blue-600">
                            <span>OVPred</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="OPVA" class="text-blue-600">
                            <span>OPVA</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="OVPAA" class="text-blue-600">
                            <span>OVPAA</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="VPC" class="text-blue-600">
                            <span>VPC</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="sector" value="VPSS" class="text-blue-600">
                            <span>VPSS</span>
                        </label>
                    </div>
                </div>

                <!-- Purpose and Particulars -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Purpose</label>
                        <textarea id="purpose" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter purpose of request"></textarea>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Particulars</label>
                        <textarea id="particulars" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter particulars"></textarea>
                    </div>
                </div>

                <!-- Category -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Category</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="salesInvoice" class="text-blue-600">
                            <span>Sales Invoice/Official Receipt</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="approvedPurchase" class="text-blue-600">
                            <span>Approved Purchase Request</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="proofSurrender" class="text-blue-600">
                            <span>Proof or Surrender Waste</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="specialOrder" class="text-blue-600">
                            <span>Special Order/Line Item Budget</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="postRepairInspection" class="text-blue-600">
                            <span>Request for Post Repair Inspection</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="inventoryCustodian" class="text-blue-600">
                            <span>Inventory Custodian Receipt</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="propertyAcknowledgement" class="text-blue-600">
                            <span>Property Acknowledgement Receipt</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" name="category" value="cnas" class="text-blue-600">
                            <span>CNAS</span>
                        </label>
                        <div>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" name="category" value="others" class="text-blue-600" onchange="toggleOthersInput()">
                                <span>Others</span>
                            </label>
                            <div id="othersInput" class="ml-8 mt-2 hidden">
                                <input type="text" id="othersText" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" placeholder="Please specify...">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Total Cost -->
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Total Cost</label>
                    <input type="number" id="totalCost" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter total cost (‚Ç±)">
                </div>
                
                <button 
                    type="button"
                    onclick="saveInspectionRequest()" 
                    class="bg-green-600 hover:bg-green-700 text-white font-semibold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl w-full">
                    üìä Submit Inspection Request
                </button>
            </form>


            
            <div class="mt-8 space-y-4">
                <button 
                    onclick="goToPage1()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    ‚Üê Go Back
                </button>
                <button 
                    onclick="goToPage3()" 
                    class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    View Submitted Requests ‚Üí
                </button>
                
                <!-- Hidden Admin Access -->
                <div class="mt-8 pt-4 border-t border-gray-200">
                    <button 
                        onclick="showAdminLogin()" 
                        class="bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 text-sm w-full opacity-50">
                        üîê Admin Access
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Page 3 -->
    <div id="page3" class="min-h-screen flex items-center justify-center p-8 hidden overflow-y-auto">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-4xl w-full my-8">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span class="text-4xl">üìä</span>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-4">Your Inspection Requests</h1>
                <p class="text-gray-600">Your personal inspection request history</p>
            </div>
            
            <div id="savedDataContainer" class="mb-8">
                <div id="noDataMessage" class="text-center py-8 text-gray-500">
                    <span class="text-4xl mb-4 block">üì≠</span>
                    <p>No data saved yet. Go back to page 2 to save some data!</p>
                </div>
                
                <div id="dataDisplay" class="hidden space-y-4">
                    <!-- Saved data will appear here -->
                </div>
            </div>
            
            <div class="space-y-4">
                <div id="editModeMessage" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4 hidden">
                    <p class="text-yellow-800 text-sm">üìù <strong>Edit Mode:</strong> Click on any "Edit Request" button to modify that specific request.</p>
                </div>



                <button 
                    onclick="goToPage2()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    ‚Üê Submit New Request
                </button>
                <button 
                    onclick="goToPage1()" 
                    class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    üè† Home
                </button>
                




            </div>
        </div>
    </div>

    <!-- Page 4 - Admin Spreadsheet View -->
    <div id="page4" class="min-h-screen flex items-center justify-center p-8 hidden overflow-y-auto">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-6xl w-full my-8">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span class="text-4xl">üìä</span>
                </div>
                <h1 class="text-3xl font-bold text-gray-800 mb-4">Admin Spreadsheet View</h1>
                <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4">
                    <p class="text-sm text-red-800"><strong>üîê Admin Only:</strong> This spreadsheet view is restricted to administrators only</p>
                </div>
            </div>
            
            <div id="spreadsheetContainer" class="mb-8 overflow-x-auto">
                <div id="noSpreadsheetData" class="text-center py-8 text-gray-500">
                    <span class="text-4xl mb-4 block">üìã</span>
                    <p>No inspection requests found. Data will appear here when requests are submitted.</p>
                </div>
                
                <div id="spreadsheetDisplay" class="hidden">
                    <!-- Search and Filter Section -->
                    <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg mb-4">
                        <h3 class="font-semibold text-blue-800 mb-3">üîç Search & Filter Options</h3>
                        
                        <!-- Search Bar -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Search Text</label>
                                <input type="text" id="searchText" placeholder="Search by name, email, purpose, etc..." 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                       oninput="applyFilters()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Purchase Type</label>
                                <select id="filterPurchaseType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="applyFilters()">
                                    <option value="">All Purchase Types</option>
                                    <option value="purchases">Operations Purchase</option>
                                    <option value="ucss">UCSS Purchase</option>
                                    <option value="postRepair">Post Repair/Waste Material</option>
                                    <option value="janitorial">Janitorial Services</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Inspection Status</label>
                                <select id="filterInspectionStatus" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="applyFilters()">
                                    <option value="">All Statuses</option>
                                    <option value="Complied">Complied</option>
                                    <option value="Not Complied">Not Complied</option>
                                    <option value="Pending">Pending</option>
                                    <option value="Not Inspected">Not Inspected</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Date Range Filters -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">From Date</label>
                                <input type="date" id="filterFromDate" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                       onchange="applyFilters()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">To Date</label>
                                <input type="date" id="filterToDate" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                       onchange="applyFilters()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Quick Date Range</label>
                                <select id="quickDateRange" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="setQuickDateRange()">
                                    <option value="">Select Range</option>
                                    <option value="today">Today</option>
                                    <option value="yesterday">Yesterday</option>
                                    <option value="thisWeek">This Week</option>
                                    <option value="lastWeek">Last Week</option>
                                    <option value="thisMonth">This Month</option>
                                    <option value="lastMonth">Last Month</option>
                                    <option value="last30days">Last 30 Days</option>
                                    <option value="last90days">Last 90 Days</option>
                                    <option value="thisYear">This Year</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Sector</label>
                                <select id="filterSector" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="applyFilters()">
                                    <option value="">All Sectors</option>
                                    <option value="OP">OP</option>
                                    <option value="OVPC">OVPC</option>
                                    <option value="OVPred">OVPred</option>
                                    <option value="OPVA">OPVA</option>
                                    <option value="OVPAA">OVPAA</option>
                                    <option value="VPC">VPC</option>
                                    <option value="VPSS">VPSS</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex flex-wrap gap-2">
                            <button onclick="clearAllFilters()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm">
                                üóëÔ∏è Clear Filters
                            </button>
                            <button onclick="exportFilteredToCSV()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm">
                                üì• Export Filtered CSV
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg mb-4 flex justify-between items-center">
                        <div>
                            <h3 class="font-semibold text-gray-800">Inspection Requests Database</h3>
                            <p class="text-sm text-gray-600" id="recordCount">0 records found</p>
                            <p class="text-sm text-blue-600" id="filteredCount" style="display: none;">0 records match current filters</p>
                        </div>
                        <div class="space-x-2">
                            <button onclick="exportToCSV()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm">
                                üì• Export All CSV
                            </button>
                            <button onclick="refreshSpreadsheet()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm">
                                üîÑ Refresh
                            </button>
                            <button onclick="deleteAllData()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm">
                                üóëÔ∏è Delete All
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto border border-gray-300 rounded-lg">
                        <table id="spreadsheetTable" class="w-full bg-white" style="min-width: 2610px;">
                            <thead style="background-color: #d5e7d0;">
                                <tr class="text-sm">
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 80px;">#</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 160px;">Control #</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 140px;">Date</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 170px;">Purchase Type</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 160px;">Requested By</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 140px;">Contact</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 200px;">Personal Email</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 200px;">Institutional Email</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 160px;">Disbursing Officer</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 160px;">Office/Dept</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 120px;">Sectors</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 180px;">Purpose</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 180px;">Particulars</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 160px;">Categories</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 120px;">Total Cost</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 150px; background-color: #c8e6c9;">Date Inspected</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 150px; background-color: #c8e6c9;">Time Inspected</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 300px; background-color: #c8e6c9;">Inspected By</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 200px; background-color: #c8e6c9;">Status</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800 border-r border-gray-300" style="width: 270px; background-color: #c8e6c9;">Remarks</th>
                                    <th class="px-6 py-5 text-left font-bold text-gray-800" style="width: 120px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="spreadsheetBody">
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                <button 
                    onclick="goToPage1()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    ‚Üê Back to Home
                </button>
                <button 
                    onclick="goToPage5()" 
                    class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    üìä View Monitoring Report
                </button>
                <button 
                    onclick="logoutAdmin()" 
                    class="bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    üîê Logout Admin
                </button>
            </div>
        </div>
    </div>

    <!-- Format Display Container -->
    <div id="formatDisplayContainer" class="format-display-container hidden">
        <div class="form-pages-wrapper">
            <!-- Container for the first copy (IMO COPY) -->
            <div class="form-container">
                <span class="copy-label imo-copy">IMO COPY</span>
                <div class="header-section">
                    <!-- Logo image - using the provided URL -->
                    <img src="https://www.pup.edu.ph/resources/images/logo200.png" alt="PUP Logo" class="logo" onerror="this.src='https://placehold.co/70x70/FFFFFF/000000?text=LOGO';">
                    <div class="header-text">
                        <p>Republic of the Philippines</p>
                        <p>Polytechnic University of the Philippines</p>
                        <p>OFFICE OF EXECUTIVE VICE PRESIDENT</p>
                        <p>Inspection Management Office</p>
                    </div>
                    <div class="control-info">
                        <p>PUP-RIOS-2-IMAO-003</p>
                        <p>Effectivity Date: June 18, 2025</p>
                        <p>Rev 1</p>
                        <p>Control No:<div class="control-no-line"></div></p>
                    </div>
                </div>

                <div class="form-title">Request Form for Inspection of:</div>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="operationsPurchase1">
                        <label for="operationsPurchase1">Operations Purchase (Cash Advance, Internal Funded, External Funded)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="postRepair1">
                        <label for="postRepair1">Post-Repair/Waste Material</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="ucssPurchases1">
                        <label for="ucssPurchases1">UCSS Purchase</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="janitorialServices1">
                        <label for="janitorialServices1">Janitorial Services</label>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="input-row">
                    <span class="input-label">Date and Time Requested:</span>
                    <div class="input-field"></div>
                    <span class="input-label ml-10">Requested by:</span>
                    <div class="input-field"></div>
                </div>
                <div class="input-row">
                    <span class="input-label">Office/Department:</span>
                    <div class="input-field"></div>
                    <span class="input-label ml-10">Name of Disbursing Officer:</span>
                    <div class="input-field"></div>
                </div>
                <div class="input-row">
                    <span class="input-label">Purpose:</span>
                    <div class="input-field"></div>
                    <span class="input-label ml-10">Particulars:</span>
                    <div class="input-field"></div>
                </div>

                <div class="documentary-requirements">
                    <div class="documentary-requirements-title">Documentary Requirements: ( &#10003; or NA) <span>***** To be filled-out by Inspectors *****</span></div>
                    <div class="documentary-requirements-grid">
                        <div class="checkbox-item">
                            <input type="checkbox" id="salesInvoice1">
                            <label for="salesInvoice1">Sales Invoice/Official Receipt</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="specialOrder1">
                            <label for="specialOrder1">Special Order / Line-item budget</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="approvedPurchase1">
                            <label for="approvedPurchase1">Approved Purchase Request</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="requestPostRepair1">
                            <label for="requestPostRepair1">Request for Post-Repair and Inspection</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="proofSurrendered1">
                            <label for="proofSurrendered1">Proof of surrendered waste materials</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="inventoryCustodian1">
                            <label for="inventoryCustodian1">Inventory Custodian Slip</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="propertyAcknowledge1">
                            <label for="propertyAcknowledge1">Property Acknowledge Receipt</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="cnas1">
                            <label for="cnas1">CNAS</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="others1">
                            <label for="others1">Others:</label>
                            <div class="input-field flex-grow"></div>
                        </div>
                    </div>
                </div>

                <!-- New structure for remarks and tables -->
                <div class="main-content-wrapper">
                    <div class="top-section">
                        <div class="remarks-legend">
                            <p>Remarks:</p>
                            <p><b>C ‚Äì</b> <i>Complied</i></p>
                            <p><b>N.C ‚Äì</b> <i>Not Complied</i></p>
                        </div>

                        <div class="first-table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Document In<br>Date and Time</th>
                                        <th>Document Out<br>Date and Time</th>
                                        <th>Remarks</th>
                                        <th>C / N.C</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bottom-left-table-container">
                        <table>
                            <tbody>
                                <tr>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>

            <!-- Container for the second copy (SECOND COPY) -->
            <div class="form-container">
                <span class="copy-label second-copy">SECOND COPY</span>
                <div class="header-section">
                    <!-- Logo image - using the provided URL -->
                    <img src="https://www.pup.edu.ph/resources/images/logo200.png" alt="PUP Logo" class="logo" onerror="this.src='https://placehold.co/70x70/FFFFFF/000000?text=LOGO';">
                    <div class="header-text">
                        <p>Republic of the Philippines</p>
                        <p>Polytechnic University of the Philippines</p>
                        <p>OFFICE OF EXECUTIVE VICE PRESIDENT</p>
                        <p>Inspection Management Office</p>
                    </div>
                    <div class="control-info">
                        <p>PUP-RIOS-2-IMAO-003</p>
                        <p>Effectivity Date: June 18, 2025</p>
                        <p>Rev 1</p>
                        <p>Control No:<div class="control-no-line"></div></p>
                    </div>
                </div>

                <div class="form-title">Request Form for Inspection of:</div>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="operationsPurchase2">
                        <label for="operationsPurchase2">Operations Purchase (Cash Advance, Internal Funded, External Funded)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="postRepair2">
                        <label for="postRepair2">Post-Repair/Waste Material</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="ucssPurchases2">
                        <label for="ucssPurchases2">UCSS Purchase</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="janitorialServices2">
                        <label for="janitorialServices2">Janitorial Services</label>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="input-row">
                    <span class="input-label">Date and Time Requested:</span>
                    <div class="input-field"></div>
                    <span class="input-label ml-10">Requested by:</span>
                    <div class="input-field"></div>
                </div>
                <div class="input-row">
                    <span class="input-label">Office/Department:</span>
                    <div class="input-field"></div>
                    <span class="input-label ml-10">Name of Disbursing Officer:</span>
                    <div class="input-field"></div>
                </div>
                <div class="input-row">
                    <span class="input-label">Purpose:</span>
                    <div class="input-field"></div>
                    <span class="input-label ml-10">Particulars:</span>
                    <div class="input-field"></div>
                </div>

                <div class="documentary-requirements">
                    <div class="documentary-requirements-title">Documentary Requirements: ( &#10003; or NA) <span>***** To be filled-out by Inspectors *****</span></div>
                    <div class="documentary-requirements-grid">
                        <div class="checkbox-item">
                            <input type="checkbox" id="salesInvoice2">
                            <label for="salesInvoice2">Sales Invoice/Official Receipt</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="specialOrder2">
                            <label for="specialOrder2">Special Order / Line-item budget</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="approvedPurchase2">
                            <label for="approvedPurchase2">Approved Purchase Request</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="requestPostRepair2">
                            <label for="requestPostRepair2">Request for Post-Repair and Inspection</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="proofSurrendered2">
                            <label for="proofSurrendered2">Proof of surrendered waste materials</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="inventoryCustodian2">
                            <label for="inventoryCustodian2">Inventory Custodian Slip</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="propertyAcknowledge2">
                            <label for="propertyAcknowledge2">Property Acknowledge Receipt</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="cnas2">
                            <label for="cnas2">CNAS</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="others2">
                            <label for="others2">Others:</label>
                            <div class="input-field flex-grow"></div>
                        </div>
                    </div>
                </div>

                <!-- New structure for remarks and tables -->
                <div class="main-content-wrapper">
                    <div class="top-section">
                        <div class="remarks-legend">
                            <p>Remarks:</p>
                            <p><b>C ‚Äì</b> <i>Complied</i></p>
                            <p><b>N.C ‚Äì</b> <i>Not Complied</i></p>
                        </div>

                        <div class="first-table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Document In<br>Date and Time</th>
                                        <th>Document Out<br>Date and Time</th>
                                        <th>Remarks</th>
                                        <th>C / N.C</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bottom-left-table-container">
                        <table>
                            <tbody>
                                <tr>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page 5 - Monitoring Report -->
    <div id="page5" class="min-h-screen p-4 sm:p-6 lg:p-8 hidden overflow-y-auto">
        <div class="container-wrapper bg-white rounded-2xl shadow-2xl p-8 max-w-7xl mx-auto my-8">
            <!-- Header Section -->
            <div class="flex items-center mb-6">
                <!-- Polytechnic University of the Philippines Logo -->
                <img src="https://www.pup.edu.ph/resources/images/logo200.png" alt="PUP Logo" class="w-16 h-16 mr-4 rounded-full" onerror="this.src='https://placehold.co/64x64/FFFFFF/000000?text=LOGO';">
                <div>
                    <p class="text-xs sm:text-sm text-gray-700 font-bold">POLYTECHNIC UNIVERSITY OF THE PHILIPPINES</p>
                    <p class="text-xs sm:text-sm text-gray-600">Office of the Executive Vice President</p>
                    <p class="text-xs sm:text-sm text-gray-600">INSPECTION MANAGEMENT OFFICE</p>
                </div>
            </div>

            <!-- Report Title Section -->
            <div class="text-center my-8">
                <h1 class="text-lg sm:text-xl md:text-2xl font-bold text-gray-800 mb-2">OPERATIONS PURCHASE</h1>
                <h2 class="text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-1">INSPECTION MONITORING REPORT</h2>
                <p class="text-sm sm:text-base text-gray-600" id="reportPeriod">Period Covered: As of July 18 - August 11, 2025</p>
            </div>

            <!-- Filter Controls -->
            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6">
                <h3 class="font-semibold text-blue-800 mb-3">üìä Report Filters</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">From Date</label>
                        <input type="date" id="reportFromDate" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                               onchange="updateMonitoringReport()">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">To Date</label>
                        <input type="date" id="reportToDate" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                               onchange="updateMonitoringReport()">
                    </div>
                    <div class="flex items-end">
                        <button onclick="exportMonitoringReport()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm w-full">
                            üì• Export Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main Data Table -->
            <div class="overflow-x-auto rounded-lg shadow-sm">
                <table class="min-w-full divide-y divide-gray-200" id="monitoringTable">
                    <thead>
                        <tr style="background-color: #d5e7d0;">
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 rounded-tl-lg border-r border-gray-300" style="background-color: #d5e7d0;">No.</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Control No.</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Date and Time Requested</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Date and Time Inspected</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Name of Requester</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Item Description</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Cost</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Item Classification</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Name of SDO</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Unit/Sector</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Purpose Project</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Name of Inspector</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 border-r border-gray-300" style="background-color: #d5e7d0;">Status</th>
                            <th scope="col" class="py-5 px-6 text-sm font-bold uppercase tracking-wider text-gray-800 rounded-tr-lg" style="background-color: #d5e7d0;">Number of Days</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="monitoringTableBody">
                        <!-- Sample Data Rows -->
                        <tr class="hover:bg-gray-50">
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">1</td>
                            <td class="py-2 px-2 text-xs text-blue-600 font-mono">CN-2025-001</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jul 18, 2025 10:00 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jul 19, 2025 02:00 PM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">John Doe</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Office Supplies</td>
                            <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±1,500</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Operations Purchase</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Main Campus SDO</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Admin Office</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Daily Operations</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jane Smith</td>
                            <td class="py-2 px-2 text-xs">
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    Complied
                                </span>
                            </td>
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">1</td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">2</td>
                            <td class="py-2 px-2 text-xs text-blue-600 font-mono">CN-2025-002</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jul 20, 2025 09:30 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jul 22, 2025 11:00 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Maria Reyes</td>
                            <td class="py-2 px-2 text-xs text-gray-900">IT Equipment</td>
                            <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±25,000</td>
                            <td class="py-2 px-2 text-xs text-gray-900">UCSS Purchase</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Engineering SDO</td>
                            <td class="py-2 px-2 text-xs text-gray-900">IT Department</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Lab Upgrade</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Peter Cruz</td>
                            <td class="py-2 px-2 text-xs">
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                    Pending
                                </span>
                            </td>
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">2</td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">3</td>
                            <td class="py-2 px-2 text-xs text-blue-600 font-mono">CN-2025-003</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jul 25, 2025 02:15 PM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Jul 28, 2025 09:45 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Carlos Santos</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Laboratory Equipment</td>
                            <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±45,750</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Operations Purchase</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Science SDO</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Chemistry Lab</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Research Project</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Ana Garcia</td>
                            <td class="py-2 px-2 text-xs">
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    Complied
                                </span>
                            </td>
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">3</td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">4</td>
                            <td class="py-2 px-2 text-xs text-blue-600 font-mono">CN-2025-004</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Aug 01, 2025 11:20 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Not Inspected</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Lisa Fernandez</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Maintenance Supplies</td>
                            <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±8,200</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Post Repair</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Facilities SDO</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Maintenance</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Building Repair</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Not Assigned</td>
                            <td class="py-2 px-2 text-xs">
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                    Pending
                                </span>
                            </td>
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">10</td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">5</td>
                            <td class="py-2 px-2 text-xs text-blue-600 font-mono">CN-2025-005</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Aug 05, 2025 03:45 PM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Aug 07, 2025 10:30 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Robert Kim</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Cleaning Services</td>
                            <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±12,500</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Janitorial Services</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Campus SDO</td>
                            <td class="py-2 px-2 text-xs text-gray-900">General Services</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Campus Maintenance</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Mike Torres</td>
                            <td class="py-2 px-2 text-xs">
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                    Not Complied
                                </span>
                            </td>
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">2</td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">6</td>
                            <td class="py-2 px-2 text-xs text-blue-600 font-mono">CN-2025-006</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Aug 08, 2025 08:15 AM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Aug 10, 2025 01:20 PM</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Sarah Johnson</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Medical Supplies</td>
                            <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±18,900</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Operations Purchase</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Health Center SDO</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Medical Services</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Student Health</td>
                            <td class="py-2 px-2 text-xs text-gray-900">Dr. Martinez</td>
                            <td class="py-2 px-2 text-xs">
                                <span class="px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    Complied
                                </span>
                            </td>
                            <td class="py-2 px-2 text-xs text-gray-900 text-center">2</td>
                        </tr>
                    </tbody>
                </table>
            </div>



            <!-- Navigation -->
            <div class="mt-8 space-y-4">
                <button 
                    onclick="goToPage4()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    ‚Üê Back to Admin Panel
                </button>
                <button 
                    onclick="goToPage1()" 
                    class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 w-full">
                    üè† Home
                </button>
            </div>
        </div>
    </div>

    <script>
        function goToPage1() {
            document.getElementById('page1').classList.remove('hidden');
            document.getElementById('page2').classList.add('hidden');
            document.getElementById('page3').classList.add('hidden');
            document.getElementById('page4').classList.add('hidden');
            hideFormDisplays(); // Hide forms when navigating
        }

        function agreePrivacy() {
            // User agreed to privacy terms, proceed to page 2
            document.getElementById('page1').classList.add('hidden');
            document.getElementById('page2').classList.remove('hidden');
            document.getElementById('page3').classList.add('hidden');
            document.getElementById('page4').classList.add('hidden');
        }

        function disagreePrivacy() {
            // User disagreed, show message and close/redirect
            alert('Thank you for your time. You have chosen not to proceed with our application.');
            // In a real application, this would redirect to another page or close the window
            // For demo purposes, we'll just show the message
        }

        function goToPage2() {
            document.getElementById('page1').classList.add('hidden');
            document.getElementById('page2').classList.remove('hidden');
            document.getElementById('page3').classList.add('hidden');
            hideFormDisplays(); // Hide forms when navigating
        }

        function goToPage3() {
            document.getElementById('page1').classList.add('hidden');
            document.getElementById('page2').classList.add('hidden');
            document.getElementById('page3').classList.remove('hidden');
            hideFormDisplays(); // Hide forms when navigating
            displaySavedData();
        }

        function toggleUCSSOptions() {
            const ucssRadio = document.querySelector('input[name="purchaseType"][value="purchases"]');
            const ucssOptions = document.getElementById('ucssOptions');
            
            if (ucssRadio.checked) {
                ucssOptions.classList.remove('hidden');
            } else {
                ucssOptions.classList.add('hidden');
                // Clear UCSS sub-type selections when hiding
                document.querySelectorAll('input[name="ucssSubType"]').forEach(cb => cb.checked = false);
            }
        }

        function toggleOthersInput() {
            const othersCheckbox = document.querySelector('input[name="category"][value="others"]');
            const othersInput = document.getElementById('othersInput');
            const othersText = document.getElementById('othersText');
            
            if (othersCheckbox.checked) {
                othersInput.classList.remove('hidden');
            } else {
                othersInput.classList.add('hidden');
                othersText.value = ''; // Clear the text when hiding
            }
        }

        function saveInspectionRequest() {
            // Get all form values
            const purchaseType = document.querySelector('input[name="purchaseType"]:checked')?.value || '';
            const ucssSubTypes = Array.from(document.querySelectorAll('input[name="ucssSubType"]:checked')).map(cb => cb.value);
            const contactNumber = document.getElementById('contactNumber').value;
            const personalEmail = document.getElementById('personalEmail').value;
            const institutionalEmail = document.getElementById('institutionalEmail').value;
            const requestedBy = document.getElementById('requestedBy').value;
            const disbursingOfficer = document.getElementById('disbursingOfficer').value;
            const officeDepartment = document.getElementById('officeDepartment').value;
            const purpose = document.getElementById('purpose').value;
            const particulars = document.getElementById('particulars').value;
            const totalCost = document.getElementById('totalCost').value;

            // Get selected sectors
            const sectors = Array.from(document.querySelectorAll('input[name="sector"]:checked')).map(cb => cb.value);
            
            // Get selected categories
            const categories = Array.from(document.querySelectorAll('input[name="category"]:checked')).map(cb => cb.value);
            const othersText = document.getElementById('othersText').value;

            // Basic validation
            if (!purchaseType || !contactNumber || !personalEmail || !requestedBy || !disbursingOfficer || !purpose || !totalCost) {
                alert('Please fill in all required fields before submitting!');
                return;
            }

            if (sectors.length === 0) {
                alert('Please select at least one sector!');
                return;
            }

            if (categories.length === 0) {
                alert('Please select at least one category!');
                return;
            }

            // Show loading state
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ Submitting Request...';
            button.disabled = true;

            // Simulate Google Sheets API call
            setTimeout(() => {
                // Get existing data from localStorage (simulating Google Sheets data)
                let savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
                
                // Check if we're editing an existing entry
                if (window.editingEntryId) {
                    // Find and update existing entry
                    const entryIndex = savedData.findIndex(entry => entry.id === window.editingEntryId);
                    if (entryIndex !== -1) {
                        // Update existing entry, keeping original ID and sheetRow
                        savedData[entryIndex] = {
                            ...savedData[entryIndex], // Keep original id, timestamp, sheetRow
                            purchaseType: purchaseType,
                            ucssSubTypes: ucssSubTypes,
                            contactNumber: contactNumber,
                            personalEmail: personalEmail,
                            institutionalEmail: institutionalEmail,
                            requestedBy: requestedBy,
                            disbursingOfficer: disbursingOfficer,
                            officeDepartment: officeDepartment,
                            sectors: sectors,
                            purpose: purpose,
                            particulars: particulars,
                            categories: categories,
                            othersText: othersText,
                            totalCost: parseFloat(totalCost),
                            lastModified: new Date().toLocaleString()
                        };
                        
                        // Clear editing state
                        delete window.editingEntryId;
                        
                        // Remove edit notification
                        const editNotification = document.getElementById('editNotification');
                        if (editNotification) {
                            editNotification.remove();
                        }
                        
                        // Reset button appearance
                        button.innerHTML = 'üìä Submit Inspection Request';
                        button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                        button.classList.add('bg-green-600', 'hover:bg-green-700');
                        
                        // Save back to localStorage
                        localStorage.setItem('inspectionRequests', JSON.stringify(savedData));
                        
                        // Clear form
                        document.getElementById('inspectionForm').reset();
                        
                        // Reset button
                        button.innerHTML = 'üìä Submit Inspection Request';
                        button.disabled = false;
                        
                        // Show success message
                        alert(`‚úÖ Inspection request updated successfully!\nüìä Row ${savedData[entryIndex].sheetRow}\nüïí ${savedData[entryIndex].lastModified}`);
                        return;
                    }
                }
                
                // Generate unique control number FIRST
                const controlNumber = generateControlNumber();
                
                // Create user identifier based on email and name
                const currentUser = `${personalEmail}_${requestedBy}`.toLowerCase().replace(/\s+/g, '');
                
                // Clear previous user's data from display (keep in main storage for admin)
                localStorage.removeItem('currentUserRequests');
                
                // Add new entry with timestamp and sheet row simulation
                const newEntry = {
                    id: Date.now(),
                    controlNumber: controlNumber,
                    purchaseType: purchaseType,
                    ucssSubTypes: ucssSubTypes,
                    contactNumber: contactNumber,
                    personalEmail: personalEmail,
                    institutionalEmail: institutionalEmail,
                    requestedBy: requestedBy,
                    disbursingOfficer: disbursingOfficer,
                    officeDepartment: officeDepartment,
                    sectors: sectors,
                    purpose: purpose,
                    particulars: particulars,
                    categories: categories,
                    othersText: othersText,
                    totalCost: parseFloat(totalCost),
                    timestamp: new Date().toLocaleString(),
                    sheetRow: savedData.length + 2, // Simulate Google Sheets row number
                    userId: currentUser // Add user identifier
                };
                
                // Add to main saved data (for admin view)
                savedData.push(newEntry);
                localStorage.setItem('inspectionRequests', JSON.stringify(savedData));
                
                // Set current user's requests (only this user's data)
                localStorage.setItem('currentUserRequests', JSON.stringify([newEntry]));
                localStorage.setItem('currentUserId', currentUser);
                
                // Clear form
                document.getElementById('inspectionForm').reset();
                
                // Reset button
                button.innerHTML = originalText;
                button.disabled = false;
                
                // Show success message with control number
                alert(`‚úÖ Inspection request submitted successfully!\nüé´ Control Number: ${controlNumber}\nüìä Added to row ${newEntry.sheetRow}\nüïí ${newEntry.timestamp}`);
            }, 2000); // Simulate network delay
        }



        function viewFormDetails(id) {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const entry = savedData.find(e => e.id === id);
            
            if (!entry) {
                alert('Form not found!');
                return;
            }
            
            const details = `
üìã INSPECTION REQUEST DETAILS

üé´ Control Number: ${entry.controlNumber || 'Not Assigned'}
üìÖ Date: ${entry.timestamp}
${entry.lastModified ? `‚úèÔ∏è Last Modified: ${entry.lastModified}` : ''}

üë§ CONTACT INFORMATION:
‚Ä¢ Requested By: ${entry.requestedBy}
‚Ä¢ Contact: ${entry.contactNumber}
‚Ä¢ Personal Email: ${entry.personalEmail}
‚Ä¢ Institutional Email: ${entry.institutionalEmail}
‚Ä¢ Disbursing Officer: ${entry.disbursingOfficer}
‚Ä¢ Office/Department: ${entry.officeDepartment}

üè¢ PURCHASE TYPE:
‚Ä¢ ${entry.purchaseType}${entry.ucssSubTypes && entry.ucssSubTypes.length > 0 ? ` (${entry.ucssSubTypes.join(', ')})` : ''}

üéØ SECTORS:
‚Ä¢ ${entry.sectors.join(', ')}

üìù PURPOSE & PARTICULARS:
‚Ä¢ Purpose: ${entry.purpose}
‚Ä¢ Particulars: ${entry.particulars}

üìã CATEGORIES:
‚Ä¢ ${entry.categories.join(', ')}${entry.othersText ? ` (Others: ${entry.othersText})` : ''}

üí∞ TOTAL COST: ‚Ç±${entry.totalCost.toLocaleString()}
            `;
            
            alert(details);
        }

        function displaySavedData() {
            // Get only current user's requests
            const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
            const noDataMessage = document.getElementById('noDataMessage');
            const dataDisplay = document.getElementById('dataDisplay');
            
            if (currentUserData.length === 0) {
                noDataMessage.classList.remove('hidden');
                dataDisplay.classList.add('hidden');
            } else {
                noDataMessage.classList.add('hidden');
                dataDisplay.classList.remove('hidden');
                
                // Sort by newest first (highest ID first)
                const sortedData = currentUserData.sort((a, b) => b.id - a.id);
                
                dataDisplay.innerHTML = sortedData.map((entry, index) => `
                    <div class="bg-green-50 rounded-lg p-6 border border-green-200 mb-4">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800 text-lg">Your Request #${sortedData.length - index}</h3>
                                ${entry.controlNumber ? `<span class="text-sm text-blue-600 font-mono">üé´ ${entry.controlNumber}</span>` : ''}
                            </div>
                            <div class="text-right">
                                <span class="text-xs text-green-600 block">üìä Row ${entry.sheetRow}</span>
                                <span class="text-xs text-gray-500">${entry.timestamp}</span>
                                ${entry.lastModified ? `<span class="text-xs text-blue-500 block">‚úèÔ∏è Modified: ${entry.lastModified}</span>` : ''}
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div><strong>Purchase Type:</strong> ${entry.purchaseType}${entry.ucssSubTypes && entry.ucssSubTypes.length > 0 ? ` (${entry.ucssSubTypes.join(', ')})` : ''}</div>
                            <div><strong>Requested By:</strong> ${entry.requestedBy}</div>
                            <div><strong>Contact:</strong> ${entry.contactNumber}</div>
                            <div><strong>Email:</strong> ${entry.personalEmail}</div>
                            <div><strong>Disbursing Officer:</strong> ${entry.disbursingOfficer}</div>
                            <div><strong>Office/Department:</strong> ${entry.officeDepartment}</div>
                        </div>
                        
                        <div class="mt-4 text-sm">
                            <div class="mb-2"><strong>Sectors:</strong> ${entry.sectors.join(', ')}</div>
                            <div class="mb-2"><strong>Categories:</strong> ${entry.categories.join(', ')}${entry.othersText ? ` (Others: ${entry.othersText})` : ''}</div>
                            <div class="mb-2"><strong>Purpose:</strong> ${entry.purpose}</div>
                            <div class="mb-2"><strong>Particulars:</strong> ${entry.particulars}</div>
                            <div class="mb-2"><strong>Total Cost:</strong> ‚Ç±${entry.totalCost.toLocaleString()}</div>
                        </div>
                        
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
                            <button onclick="editEntry(${entry.id})" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 flex items-center justify-center">
                                ‚úèÔ∏è Edit Request
                            </button>
                            <button onclick="fillFormDisplays(${entry.id})" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 flex items-center justify-center">
                                üìã View in Forms
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function editEntry(id) {
            // Find the entry to edit from current user's data
            const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
            const entryToEdit = currentUserData.find(entry => entry.id === id);
            
            if (!entryToEdit) {
                alert('Request not found!');
                return;
            }
            
            // Go to page 2 (form page)
            goToPage2();
            
            // Populate the form with existing data
            setTimeout(() => {
                // Purchase Type
                const purchaseTypeRadio = document.querySelector(`input[name="purchaseType"][value="${entryToEdit.purchaseType}"]`);
                if (purchaseTypeRadio) {
                    purchaseTypeRadio.checked = true;
                    toggleUCSSOptions(); // Show UCSS options if needed
                }
                
                // UCSS Sub Types
                if (entryToEdit.ucssSubTypes && entryToEdit.ucssSubTypes.length > 0) {
                    entryToEdit.ucssSubTypes.forEach(subType => {
                        const checkbox = document.querySelector(`input[name="ucssSubType"][value="${subType}"]`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
                
                // Contact Information
                document.getElementById('contactNumber').value = entryToEdit.contactNumber || '';
                document.getElementById('personalEmail').value = entryToEdit.personalEmail || '';
                document.getElementById('institutionalEmail').value = entryToEdit.institutionalEmail || '';
                document.getElementById('requestedBy').value = entryToEdit.requestedBy || '';
                document.getElementById('disbursingOfficer').value = entryToEdit.disbursingOfficer || '';
                document.getElementById('officeDepartment').value = entryToEdit.officeDepartment || '';
                
                // Sectors
                if (entryToEdit.sectors && entryToEdit.sectors.length > 0) {
                    entryToEdit.sectors.forEach(sector => {
                        const checkbox = document.querySelector(`input[name="sector"][value="${sector}"]`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
                
                // Purpose and Particulars
                document.getElementById('purpose').value = entryToEdit.purpose || '';
                document.getElementById('particulars').value = entryToEdit.particulars || '';
                
                // Categories
                if (entryToEdit.categories && entryToEdit.categories.length > 0) {
                    entryToEdit.categories.forEach(category => {
                        const checkbox = document.querySelector(`input[name="category"][value="${category}"]`);
                        if (checkbox) {
                            checkbox.checked = true;
                            if (category === 'others') {
                                toggleOthersInput();
                            }
                        }
                    });
                }
                
                // Others text
                if (entryToEdit.othersText) {
                    document.getElementById('othersText').value = entryToEdit.othersText;
                }
                
                // Total Cost
                document.getElementById('totalCost').value = entryToEdit.totalCost || '';
                
                // Store the ID of the entry being edited
                window.editingEntryId = id;
                
                // Change the submit button to indicate editing
                const submitButton = document.querySelector('button[onclick="saveInspectionRequest()"]');
                submitButton.innerHTML = '‚úèÔ∏è Update Inspection Request';
                submitButton.classList.remove('bg-green-600', 'hover:bg-green-700');
                submitButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
                
                // Show edit notification
                const editNotification = document.createElement('div');
                editNotification.id = 'editNotification';
                editNotification.className = 'bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4';
                editNotification.innerHTML = '<p class="text-sm text-blue-800"><strong>Edit Mode:</strong> You are currently editing an existing request. Click "Update" to save changes.</p>';
                
                const form = document.getElementById('inspectionForm');
                form.parentNode.insertBefore(editNotification, form);
                
                // Scroll to top of form
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
            }, 100); // Small delay to ensure page transition completes
        }

        function generateControlNumber() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const date = String(now.getDate()).padStart(2, '0');
            
            // Get existing data to determine next sequence number
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const today = `${year}${month}${date}`;
            
            // Find all control numbers from today
            const todayNumbers = savedData
                .filter(entry => entry.controlNumber && entry.controlNumber.startsWith(today))
                .map(entry => {
                    const parts = entry.controlNumber.split('-');
                    return parts.length > 1 ? parseInt(parts[1]) : 0;
                })
                .filter(num => !isNaN(num));
            
            // Get next sequence number
            const nextSequence = todayNumbers.length > 0 ? Math.max(...todayNumbers) + 1 : 1;
            const sequenceStr = String(nextSequence).padStart(3, '0');
            
            return `${today}-${sequenceStr}`;
        }

        function fillFormDisplays(id) {
            // Find the entry to display
            const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
            const entryToDisplay = currentUserData.find(entry => entry.id === id);
            
            if (!entryToDisplay) {
                alert('Request not found!');
                return;
            }
            
            // Show the form display container
            const formatDisplayContainer = document.getElementById('formatDisplayContainer');
            if (formatDisplayContainer) {
                formatDisplayContainer.classList.remove('hidden');
            }
            
            // Clear all form fields first
            clearAllFormFields();
            
            // Fill both form copies with the data
            fillFormCopy(entryToDisplay, 1); // IMO COPY
            fillFormCopy(entryToDisplay, 2); // SECOND COPY
            
            // Scroll to the form display area
            if (formatDisplayContainer) {
                formatDisplayContainer.scrollIntoView({ behavior: 'smooth' });
            }
            
            // Add print button and close button to the form display area
            addFormControlButtons(entryToDisplay.id);
            
            // Show success message
            alert(`‚úÖ Form displays have been filled with your request data!\nüé´ Control Number: ${entryToDisplay.controlNumber || 'Not Assigned'}\nüìã Scroll down to view the filled forms.\nüñ®Ô∏è Use the "Print Forms" button to print both copies!`);
        }

        function clearAllFormFields() {
            // Clear all checkboxes and input fields in both forms
            for (let copyNum = 1; copyNum <= 2; copyNum++) {
                // Clear checkboxes
                const checkboxes = document.querySelectorAll(`#operationsPurchase${copyNum}, #postRepair${copyNum}, #ucssPurchases${copyNum}, #janitorialServices${copyNum}, #salesInvoice${copyNum}, #specialOrder${copyNum}, #approvedPurchase${copyNum}, #requestPostRepair${copyNum}, #proofSurrendered${copyNum}, #inventoryCustodian${copyNum}, #propertyAcknowledge${copyNum}, #cnas${copyNum}, #others${copyNum}`);
                checkboxes.forEach(cb => cb.checked = false);
                
                // Clear input fields (control number lines and others field)
                const controlLines = document.querySelectorAll('.control-no-line');
                controlLines.forEach(line => line.textContent = '');
                
                // Clear others input fields
                const othersFields = document.querySelectorAll('.input-field');
                othersFields.forEach(field => field.textContent = '');
            }
        }

        function fillFormCopy(entry, copyNumber) {
            // Fill control number
            const controlLines = document.querySelectorAll('.control-no-line');
            if (controlLines[copyNumber - 1]) {
                controlLines[copyNumber - 1].textContent = entry.controlNumber || '';
            }
            
            // Map purchase types to form checkboxes
            const purchaseTypeMapping = {
                'purchases': `ucssPurchases${copyNumber}`,
                'postRepair': `postRepair${copyNumber}`,
                'janitorial': `janitorialServices${copyNumber}`,
                'cashAdvanceMain': `operationsPurchase${copyNumber}`,
                'internal': `operationsPurchase${copyNumber}`,
                'external': `operationsPurchase${copyNumber}`
            };
            
            // Check the appropriate purchase type
            const purchaseCheckbox = document.getElementById(purchaseTypeMapping[entry.purchaseType]);
            if (purchaseCheckbox) {
                purchaseCheckbox.checked = true;
            }
            
            // Map categories to form checkboxes
            const categoryMapping = {
                'salesInvoice': `salesInvoice${copyNumber}`,
                'specialOrder': `specialOrder${copyNumber}`,
                'approvedPurchase': `approvedPurchase${copyNumber}`,
                'postRepairInspection': `requestPostRepair${copyNumber}`,
                'proofSurrender': `proofSurrendered${copyNumber}`,
                'inventoryCustodian': `inventoryCustodian${copyNumber}`,
                'propertyAcknowledgement': `propertyAcknowledge${copyNumber}`,
                'cnas': `cnas${copyNumber}`,
                'others': `others${copyNumber}`
            };
            
            // Check the appropriate categories
            if (entry.categories && entry.categories.length > 0) {
                entry.categories.forEach(category => {
                    const categoryCheckbox = document.getElementById(categoryMapping[category]);
                    if (categoryCheckbox) {
                        categoryCheckbox.checked = true;
                    }
                });
            }
            
            // Get all form containers to target the specific copy
            const formContainers = document.querySelectorAll('.form-container');
            const targetContainer = formContainers[copyNumber - 1];
            
            if (targetContainer) {
                // Fill text fields using the input-row structure within the specific container
                const inputRows = targetContainer.querySelectorAll('.input-row');
                
                // Fill Date and Time Requested & Requested by (first row)
                if (inputRows[0]) {
                    const fields = inputRows[0].querySelectorAll('.input-field');
                    if (fields[0]) fields[0].textContent = entry.timestamp || '';
                    if (fields[1]) fields[1].textContent = entry.requestedBy || '';
                }
                
                // Fill Office/Department & Name of Disbursing Officer (second row)
                if (inputRows[1]) {
                    const fields = inputRows[1].querySelectorAll('.input-field');
                    if (fields[0]) fields[0].textContent = entry.officeDepartment || '';
                    if (fields[1]) fields[1].textContent = entry.disbursingOfficer || '';
                }
                
                // Fill Purpose & Particulars (third row)
                if (inputRows[2]) {
                    const fields = inputRows[2].querySelectorAll('.input-field');
                    if (fields[0]) fields[0].textContent = entry.purpose || '';
                    if (fields[1]) fields[1].textContent = entry.particulars || '';
                }
                
                // Fill others text field if others category is selected
                if (entry.categories && entry.categories.includes('others') && entry.othersText) {
                    const othersRow = targetContainer.querySelector(`#others${copyNumber}`);
                    if (othersRow) {
                        const othersField = othersRow.closest('.checkbox-item').querySelector('.input-field');
                        if (othersField) {
                            othersField.textContent = entry.othersText;
                        }
                    }
                }
            }
        }

        function clearAllData() {
            if (confirm('Are you sure you want to delete all inspection requests? This cannot be undone.')) {
                localStorage.removeItem('inspectionRequests');
                displaySavedData();
                alert('All inspection requests have been cleared! üóëÔ∏è');
            }
        }

        // Admin Functions
        function showAdminLogin() {
            const password = prompt('üîê Enter Admin Password:');
            if (password === 'admin123') {
                // Store admin session
                sessionStorage.setItem('adminLoggedIn', 'true');
                goToPage4();
            } else if (password !== null) {
                alert('‚ùå Incorrect password. Access denied.');
            }
        }

        function goToPage4() {
            // Check if admin is logged in
            if (sessionStorage.getItem('adminLoggedIn') !== 'true') {
                alert('‚ùå Admin access required. Please login first.');
                return;
            }
            
            document.getElementById('page1').classList.add('hidden');
            document.getElementById('page2').classList.add('hidden');
            document.getElementById('page3').classList.add('hidden');
            document.getElementById('page4').classList.remove('hidden');
            document.getElementById('page5').classList.add('hidden');
            hideFormDisplays(); // Hide forms when navigating
            displaySpreadsheet();
        }

        function goToPage5() {
            // Check if admin is logged in
            if (sessionStorage.getItem('adminLoggedIn') !== 'true') {
                alert('‚ùå Admin access required. Please login first.');
                return;
            }
            
            document.getElementById('page1').classList.add('hidden');
            document.getElementById('page2').classList.add('hidden');
            document.getElementById('page3').classList.add('hidden');
            document.getElementById('page4').classList.add('hidden');
            document.getElementById('page5').classList.remove('hidden');
            hideFormDisplays(); // Hide forms when navigating
            displayMonitoringReport();
        }

        // Global variable to store filtered data
        let filteredData = [];

        function displaySpreadsheet() {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const noDataMessage = document.getElementById('noSpreadsheetData');
            const spreadsheetDisplay = document.getElementById('spreadsheetDisplay');
            const recordCount = document.getElementById('recordCount');
            
            if (savedData.length === 0) {
                noDataMessage.classList.remove('hidden');
                spreadsheetDisplay.classList.add('hidden');
            } else {
                noDataMessage.classList.add('hidden');
                spreadsheetDisplay.classList.remove('hidden');
                recordCount.textContent = `${savedData.length} records found`;
                
                // Sort by newest first and store as filtered data
                filteredData = savedData.sort((a, b) => b.id - a.id);
                
                // Apply any existing filters
                applyFilters();
            }
        }

        function renderSpreadsheetTable(dataToRender) {
            const spreadsheetBody = document.getElementById('spreadsheetBody');
            const filteredCount = document.getElementById('filteredCount');
            const allData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            
            // Show filtered count if filters are applied
            if (dataToRender.length !== allData.length) {
                filteredCount.style.display = 'block';
                filteredCount.textContent = `${dataToRender.length} records match current filters`;
            } else {
                filteredCount.style.display = 'none';
            }
            
            spreadsheetBody.innerHTML = dataToRender.map((entry, index) => `
                <tr class="border-b hover:bg-gray-50 text-sm">
                    <td class="px-4 py-3 border-r text-center">${index + 1}</td>
                    <td class="px-4 py-3 border-r font-mono text-blue-600">${entry.controlNumber || 'N/A'}</td>
                    <td class="px-4 py-3 border-r">${entry.timestamp}</td>
                    <td class="px-4 py-3 border-r">${entry.purchaseType}${entry.ucssSubTypes && entry.ucssSubTypes.length > 0 ? ` (${entry.ucssSubTypes.join(', ')})` : ''}</td>
                    <td class="px-4 py-3 border-r">${entry.requestedBy}</td>
                    <td class="px-4 py-3 border-r">${entry.contactNumber}</td>
                    <td class="px-4 py-3 border-r">${entry.personalEmail}</td>
                    <td class="px-4 py-3 border-r">${entry.institutionalEmail}</td>
                    <td class="px-4 py-3 border-r">${entry.disbursingOfficer}</td>
                    <td class="px-4 py-3 border-r">${entry.officeDepartment}</td>
                    <td class="px-4 py-3 border-r">${entry.sectors.join(', ')}</td>
                    <td class="px-4 py-3 border-r" title="${entry.purpose}">${entry.purpose.length > 50 ? entry.purpose.substring(0, 50) + '...' : entry.purpose}</td>
                    <td class="px-4 py-3 border-r" title="${entry.particulars}">${entry.particulars.length > 50 ? entry.particulars.substring(0, 50) + '...' : entry.particulars}</td>
                    <td class="px-4 py-3 border-r">${entry.categories.join(', ')}${entry.othersText ? ` (${entry.othersText})` : ''}</td>
                    <td class="px-4 py-3 border-r font-semibold text-green-600">‚Ç±${entry.totalCost.toLocaleString()}</td>
                    <td class="px-4 py-3 border-r bg-blue-50">
                        <input type="date" value="${entry.dateInspected || ''}" 
                               onchange="updateInspectionField(${entry.id}, 'dateInspected', this.value)"
                               class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                    </td>
                    <td class="px-4 py-3 border-r bg-blue-50">
                        <input type="time" value="${entry.timeInspected || ''}" 
                               onchange="updateInspectionField(${entry.id}, 'timeInspected', this.value)"
                               class="w-full text-sm border border-gray-300 rounded px-2 py-1">
                    </td>
                    <td class="px-4 py-3 border-r bg-blue-50">
                        <select onchange="updateInspectionField(${entry.id}, 'inspectedBy', this.value)"
                                class="w-full text-sm border border-gray-300 rounded px-2 py-1"
                                style="min-width: 260px;">
                            <option value="">Select Inspector</option>
                            <option value="Dr. Ferdinand O. Natividad" ${entry.inspectedBy === 'Dr. Ferdinand O. Natividad' ? 'selected' : ''}>Dr. Ferdinand O. Natividad</option>
                            <option value="Ch. Jonathan C. Manarang" ${entry.inspectedBy === 'Ch. Jonathan C. Manarang' ? 'selected' : ''}>Ch. Jonathan C. Manarang</option>
                            <option value="Ins. Carmelo T. Osorio" ${entry.inspectedBy === 'Ins. Carmelo T. Osorio' ? 'selected' : ''}>Ins. Carmelo T. Osorio</option>
                            <option value="Ins. Ara Deither Lei Y. De Chavez" ${entry.inspectedBy === 'Ins. Ara Deither Lei Y. De Chavez' ? 'selected' : ''}>Ins. Ara Deither Lei Y. De Chavez</option>
                        </select>
                    </td>
                    <td class="px-4 py-3 border-r bg-blue-50">
                        <select onchange="updateInspectionField(${entry.id}, 'inspectionStatus', this.value)"
                                class="w-full text-sm border border-gray-300 rounded px-2 py-1"
                                style="min-width: 160px;">
                            <option value="">Select Status</option>
                            <option value="Complied" ${entry.inspectionStatus === 'Complied' ? 'selected' : ''}>Complied</option>
                            <option value="Not Complied" ${entry.inspectionStatus === 'Not Complied' ? 'selected' : ''}>Not Complied</option>
                            <option value="Pending" ${entry.inspectionStatus === 'Pending' ? 'selected' : ''}>Pending</option>
                        </select>
                    </td>
                    <td class="px-4 py-3 border-r bg-blue-50">
                        <textarea onchange="updateInspectionField(${entry.id}, 'inspectionRemarks', this.value)"
                                  placeholder="Enter detailed remarks..."
                                  class="w-full text-sm border border-gray-300 rounded px-2 py-1 resize-vertical"
                                  style="min-width: 230px; min-height: 40px;"
                                  rows="3">${entry.inspectionRemarks || ''}</textarea>
                    </td>
                    <td class="px-4 py-3 text-center">
                        <button onclick="deleteSpecificEntry(${entry.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors" title="Delete this request">
                            üóëÔ∏è Delete
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function applyFilters() {
            const allData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const searchText = document.getElementById('searchText').value.toLowerCase();
            const filterPurchaseType = document.getElementById('filterPurchaseType').value;
            const filterInspectionStatus = document.getElementById('filterInspectionStatus').value;
            const filterFromDate = document.getElementById('filterFromDate').value;
            const filterToDate = document.getElementById('filterToDate').value;
            const filterSector = document.getElementById('filterSector').value;
            
            filteredData = allData.filter(entry => {
                // Text search across multiple fields
                const searchableText = [
                    entry.requestedBy,
                    entry.personalEmail,
                    entry.institutionalEmail,
                    entry.disbursingOfficer,
                    entry.officeDepartment,
                    entry.purpose,
                    entry.particulars,
                    entry.controlNumber,
                    entry.contactNumber,
                    entry.sectors.join(' '),
                    entry.categories.join(' '),
                    entry.othersText || '',
                    entry.inspectedBy || '',
                    entry.inspectionRemarks || ''
                ].join(' ').toLowerCase();
                
                const matchesSearch = !searchText || searchableText.includes(searchText);
                
                // Purchase type filter
                const matchesPurchaseType = !filterPurchaseType || entry.purchaseType === filterPurchaseType;
                
                // Inspection status filter
                let matchesInspectionStatus = true;
                if (filterInspectionStatus) {
                    if (filterInspectionStatus === 'Not Inspected') {
                        matchesInspectionStatus = !entry.inspectionStatus || entry.inspectionStatus === '';
                    } else {
                        matchesInspectionStatus = entry.inspectionStatus === filterInspectionStatus;
                    }
                }
                
                // Date range filter
                let matchesDateRange = true;
                if (filterFromDate || filterToDate) {
                    const entryDate = new Date(entry.timestamp);
                    const fromDate = filterFromDate ? new Date(filterFromDate) : null;
                    const toDate = filterToDate ? new Date(filterToDate + 'T23:59:59') : null;
                    
                    if (fromDate && entryDate < fromDate) matchesDateRange = false;
                    if (toDate && entryDate > toDate) matchesDateRange = false;
                }
                
                // Sector filter
                const matchesSector = !filterSector || entry.sectors.includes(filterSector);
                
                return matchesSearch && matchesPurchaseType && matchesInspectionStatus && matchesDateRange && matchesSector;
            });
            
            // Sort filtered data by newest first
            filteredData.sort((a, b) => b.id - a.id);
            
            // Render the filtered data
            renderSpreadsheetTable(filteredData);
        }

        function setQuickDateRange() {
            const quickRange = document.getElementById('quickDateRange').value;
            const fromDateInput = document.getElementById('filterFromDate');
            const toDateInput = document.getElementById('filterToDate');
            
            if (!quickRange) return;
            
            const today = new Date();
            let fromDate, toDate;
            
            switch (quickRange) {
                case 'today':
                    fromDate = toDate = today;
                    break;
                case 'yesterday':
                    fromDate = toDate = new Date(today.getTime() - 24 * 60 * 60 * 1000);
                    break;
                case 'thisWeek':
                    const startOfWeek = new Date(today);
                    startOfWeek.setDate(today.getDate() - today.getDay());
                    fromDate = startOfWeek;
                    toDate = today;
                    break;
                case 'lastWeek':
                    const lastWeekEnd = new Date(today.getTime() - today.getDay() * 24 * 60 * 60 * 1000);
                    const lastWeekStart = new Date(lastWeekEnd.getTime() - 6 * 24 * 60 * 60 * 1000);
                    fromDate = lastWeekStart;
                    toDate = lastWeekEnd;
                    break;
                case 'thisMonth':
                    fromDate = new Date(today.getFullYear(), today.getMonth(), 1);
                    toDate = today;
                    break;
                case 'lastMonth':
                    fromDate = new Date(today.getFullYear(), today.getMonth() - 1, 1);
                    toDate = new Date(today.getFullYear(), today.getMonth(), 0);
                    break;
                case 'last30days':
                    fromDate = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);
                    toDate = today;
                    break;
                case 'last90days':
                    fromDate = new Date(today.getTime() - 90 * 24 * 60 * 60 * 1000);
                    toDate = today;
                    break;
                case 'thisYear':
                    fromDate = new Date(today.getFullYear(), 0, 1);
                    toDate = today;
                    break;
            }
            
            fromDateInput.value = fromDate.toISOString().split('T')[0];
            toDateInput.value = toDate.toISOString().split('T')[0];
            
            // Apply filters after setting dates
            applyFilters();
        }

        function clearAllFilters() {
            document.getElementById('searchText').value = '';
            document.getElementById('filterPurchaseType').value = '';
            document.getElementById('filterInspectionStatus').value = '';
            document.getElementById('filterFromDate').value = '';
            document.getElementById('filterToDate').value = '';
            document.getElementById('quickDateRange').value = '';
            document.getElementById('filterSector').value = '';
            
            applyFilters();
            
            // Show success message
            const successMsg = document.createElement('div');
            successMsg.className = 'fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm';
            successMsg.innerHTML = 'üóëÔ∏è All filters cleared!';
            document.body.appendChild(successMsg);
            
            setTimeout(() => {
                if (document.body.contains(successMsg)) {
                    document.body.removeChild(successMsg);
                }
            }, 2000);
        }

        function exportFilteredToCSV() {
            if (filteredData.length === 0) {
                alert('‚ùå No filtered data to export! Please adjust your filters or clear them to see all data.');
                return;
            }

            try {
                // Enhanced text cleaning function for proper CSV formatting
                const cleanText = (text) => {
                    if (text === null || text === undefined) return '';
                    let cleaned = String(text).trim();
                    // Replace problematic characters
                    cleaned = cleaned.replace(/"/g, '""'); // Escape quotes by doubling them
                    cleaned = cleaned.replace(/[\r\n\t]/g, ' '); // Replace line breaks and tabs with spaces
                    cleaned = cleaned.replace(/,/g, ';'); // Replace commas with semicolons to prevent column breaks
                    cleaned = cleaned.replace(/\s+/g, ' '); // Replace multiple spaces with single space
                    return cleaned;
                };
                
                // Get current filter settings
                const searchText = document.getElementById('searchText').value;
                const filterPurchaseType = document.getElementById('filterPurchaseType').value;
                const filterInspectionStatus = document.getElementById('filterInspectionStatus').value;
                const filterFromDate = document.getElementById('filterFromDate').value;
                const filterToDate = document.getElementById('filterToDate').value;
                const filterSector = document.getElementById('filterSector').value;
                
                // Create CSV with UTF-8 BOM for Excel compatibility
                const BOM = '\uFEFF';
                const csvRows = [];
                
                // Report header
                csvRows.push('"FILTERED INSPECTION REQUESTS"');
                csvRows.push('""'); // Empty row
                csvRows.push(`"Report Generated: ${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })} at ${new Date().toLocaleTimeString()}"`);
                csvRows.push(`"Filtered Records: ${filteredData.length}"`);
                csvRows.push('""'); // Empty row
                
                // Document applied filters
                csvRows.push('"APPLIED FILTERS:"');
                let hasFilters = false;
                if (searchText) {
                    csvRows.push(`"Search Text: ${cleanText(searchText)}"`);
                    hasFilters = true;
                }
                if (filterPurchaseType) {
                    csvRows.push(`"Purchase Type: ${cleanText(filterPurchaseType)}"`);
                    hasFilters = true;
                }
                if (filterInspectionStatus) {
                    csvRows.push(`"Inspection Status: ${cleanText(filterInspectionStatus)}"`);
                    hasFilters = true;
                }
                if (filterFromDate) {
                    csvRows.push(`"From Date: ${filterFromDate}"`);
                    hasFilters = true;
                }
                if (filterToDate) {
                    csvRows.push(`"To Date: ${filterToDate}"`);
                    hasFilters = true;
                }
                if (filterSector) {
                    csvRows.push(`"Sector: ${cleanText(filterSector)}"`);
                    hasFilters = true;
                }
                if (!hasFilters) {
                    csvRows.push('"No filters applied - showing all data"');
                }
                csvRows.push('""'); // Empty row
                
                // Standard column headers
                const headers = [
                    'Row #', 'Control Number', 'Date & Time', 'Purchase Type', 'UCSS Sub-Types',
                    'Requester Name', 'Contact Number', 'Personal Email', 'Institutional Email',
                    'Disbursing Officer', 'Office/Department', 'Selected Sectors', 'Purpose', 
                    'Particulars', 'Categories', 'Others', 'Total Cost (PHP)',
                    'Date Inspected', 'Time Inspected', 'Inspector Name', 'Inspection Status', 
                    'Inspection Remarks'
                ];
                csvRows.push(headers.map(h => `"${h}"`).join(','));
                
                // Calculate summary statistics for filtered data
                const totalCost = filteredData.reduce((sum, entry) => sum + (parseFloat(entry.totalCost) || 0), 0);
                const inspectedCount = filteredData.filter(entry => entry.inspectionStatus && entry.inspectionStatus !== 'Pending').length;
                
                // Process filtered data
                filteredData.forEach((entry, index) => {
                    // Build row data
                    const row = [
                        index + 1, // Row number
                        cleanText(entry.controlNumber || 'Not Assigned'),
                        cleanText(entry.timestamp || 'No Date'),
                        cleanText(entry.purchaseType || 'Not Specified'),
                        cleanText(entry.ucssSubTypes && entry.ucssSubTypes.length > 0 ? entry.ucssSubTypes.join('; ') : 'None'),
                        cleanText(entry.requestedBy || 'Not Provided'),
                        cleanText(entry.contactNumber || 'Not Provided'),
                        cleanText(entry.personalEmail || 'Not Provided'),
                        cleanText(entry.institutionalEmail || 'Not Provided'),
                        cleanText(entry.disbursingOfficer || 'Not Provided'),
                        cleanText(entry.officeDepartment || 'Not Provided'),
                        cleanText(entry.sectors && entry.sectors.length > 0 ? entry.sectors.join('; ') : 'None Selected'),
                        cleanText(entry.purpose || 'Not Provided'),
                        cleanText(entry.particulars || 'Not Provided'),
                        cleanText(entry.categories && entry.categories.length > 0 ? entry.categories.join('; ') : 'None Selected'),
                        cleanText(entry.othersText || 'N/A'),
                        parseFloat(entry.totalCost || 0).toFixed(2),
                        cleanText(entry.dateInspected || 'Not Inspected'),
                        cleanText(entry.timeInspected || 'Not Inspected'),
                        cleanText(entry.inspectedBy || 'Not Assigned'),
                        cleanText(entry.inspectionStatus || 'Pending Inspection'),
                        cleanText(entry.inspectionRemarks || 'No Remarks')
                    ];
                    
                    // Properly quote each field to prevent CSV parsing issues
                    csvRows.push(row.map(field => `"${field}"`).join(','));
                });
                
                // Add summary statistics for filtered data
                csvRows.push('""'); // Empty row
                csvRows.push('"FILTERED DATA SUMMARY"');
                csvRows.push('""'); // Empty row
                
                csvRows.push(`"Filtered Records: ${filteredData.length}"`);
                csvRows.push(`"Total Cost: PHP ${totalCost.toFixed(2)}"`);
                csvRows.push(`"Average Cost: PHP ${filteredData.length > 0 ? (totalCost / filteredData.length).toFixed(2) : 0}"`);
                csvRows.push(`"Inspected Requests: ${inspectedCount}"`);
                csvRows.push(`"Completion Rate: ${filteredData.length > 0 ? ((inspectedCount / filteredData.length) * 100).toFixed(1) : 0}%"`);
                
                // Create final CSV content
                const csvContent = BOM + csvRows.join('\r\n');
                
                // Create and download file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                // Create descriptive filename
                const dateRange = getFilterDateRangeText();
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                const filename = `Filtered_Report_${dateRange}_${timestamp}.csv`;
                
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Cleanup
                setTimeout(() => URL.revokeObjectURL(url), 100);
                
                // Success notification
                alert(`‚úÖ Filtered Export Successful!\n\nüìÅ Filename: ${filename}\nüìä Filtered Records: ${filteredData.length}\nüí∞ Total Value: ‚Ç±${totalCost.toLocaleString()}\nüìà Completion Rate: ${filteredData.length > 0 ? ((inspectedCount / filteredData.length) * 100).toFixed(1) : 0}%\nüìÇ Saved to: Downloads folder`);
                
            } catch (error) {
                console.error('Filtered export error:', error);
                alert(`‚ùå Filtered export failed: ${error.message}\n\nPlease try again or contact technical support.`);
            }
        }

        function getFilterDateRangeText() {
            const fromDate = document.getElementById('filterFromDate').value;
            const toDate = document.getElementById('filterToDate').value;
            
            if (fromDate && toDate) {
                return `${fromDate}_to_${toDate}`;
            } else if (fromDate) {
                return `from_${fromDate}`;
            } else if (toDate) {
                return `until_${toDate}`;
            } else {
                return 'all_dates';
            }
        }



        function showFilterSummary() {
            const allData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const searchText = document.getElementById('searchText').value;
            const filterPurchaseType = document.getElementById('filterPurchaseType').value;
            const filterInspectionStatus = document.getElementById('filterInspectionStatus').value;
            const filterFromDate = document.getElementById('filterFromDate').value;
            const filterToDate = document.getElementById('filterToDate').value;
            const filterSector = document.getElementById('filterSector').value;
            
            let summary = `üìä FILTER SUMMARY\n\n`;
            summary += `üìã Total Records: ${allData.length}\n`;
            summary += `üîç Filtered Records: ${filteredData.length}\n`;
            summary += `üìà Showing: ${((filteredData.length / allData.length) * 100).toFixed(1)}% of all data\n\n`;
            
            summary += `üîß ACTIVE FILTERS:\n`;
            if (searchText) summary += `‚Ä¢ Search Text: "${searchText}"\n`;
            if (filterPurchaseType) summary += `‚Ä¢ Purchase Type: ${filterPurchaseType}\n`;
            if (filterInspectionStatus) summary += `‚Ä¢ Inspection Status: ${filterInspectionStatus}\n`;
            if (filterFromDate) summary += `‚Ä¢ From Date: ${filterFromDate}\n`;
            if (filterToDate) summary += `‚Ä¢ To Date: ${filterToDate}\n`;
            if (filterSector) summary += `‚Ä¢ Sector: ${filterSector}\n`;
            
            if (!searchText && !filterPurchaseType && !filterInspectionStatus && !filterFromDate && !filterToDate && !filterSector) {
                summary += `‚Ä¢ No filters applied (showing all data)\n`;
            }
            
            // Add statistics about filtered data
            if (filteredData.length > 0) {
                const totalCost = filteredData.reduce((sum, entry) => sum + entry.totalCost, 0);
                const avgCost = totalCost / filteredData.length;
                
                summary += `\nüí∞ FINANCIAL SUMMARY:\n`;
                summary += `‚Ä¢ Total Cost: ‚Ç±${totalCost.toLocaleString()}\n`;
                summary += `‚Ä¢ Average Cost: ‚Ç±${avgCost.toLocaleString()}\n`;
                
                // Status breakdown
                const statusCounts = {};
                filteredData.forEach(entry => {
                    const status = entry.inspectionStatus || 'Not Inspected';
                    statusCounts[status] = (statusCounts[status] || 0) + 1;
                });
                
                summary += `\nüìä STATUS BREAKDOWN:\n`;
                Object.entries(statusCounts).forEach(([status, count]) => {
                    summary += `‚Ä¢ ${status}: ${count} (${((count / filteredData.length) * 100).toFixed(1)}%)\n`;
                });
            }
            
            alert(summary);
        }

        function refreshSpreadsheet() {
            displaySpreadsheet();
            alert('üìä Spreadsheet refreshed successfully!');
        }

        function exportToCSV() {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            
            if (savedData.length === 0) {
                alert('‚ùå No data to export!');
                return;
            }

            try {
                // Enhanced text cleaning function for proper CSV formatting
                const cleanText = (text) => {
                    if (text === null || text === undefined) return '';
                    let cleaned = String(text).trim();
                    // Replace problematic characters
                    cleaned = cleaned.replace(/"/g, '""'); // Escape quotes by doubling them
                    cleaned = cleaned.replace(/[\r\n\t]/g, ' '); // Replace line breaks and tabs with spaces
                    cleaned = cleaned.replace(/,/g, ';'); // Replace commas with semicolons to prevent column breaks
                    cleaned = cleaned.replace(/\s+/g, ' '); // Replace multiple spaces with single space
                    return cleaned;
                };
                
                // Create CSV with UTF-8 BOM for Excel compatibility
                const BOM = '\uFEFF';
                const csvRows = [];
                
                // Report header
                csvRows.push('""'); // Empty row
                csvRows.push('""'); // Empty row
                
                // Standard column headers
                const headers = [
                    'Row #', 'Control Number', 'Date & Time', 'Purchase Type', 'UCSS Sub-Types',
                    'Requester Name', 'Contact Number', 'Personal Email', 'Institutional Email',
                    'Disbursing Officer', 'Office/Department', 'Selected Sectors', 'Purpose', 
                    'Particulars', 'Categories', 'Others', 'Total Cost (PHP)',
                    'Date Inspected', 'Time Inspected', 'Inspector Name', 'Inspection Status', 
                    'Inspection Remarks'
                ];
                csvRows.push(headers.map(h => `"${h}"`).join(','));
                
                // Sort data by newest first for consistent export
                const sortedData = [...savedData].sort((a, b) => b.id - a.id);
                
                // Calculate summary statistics
                const totalCost = sortedData.reduce((sum, entry) => sum + (parseFloat(entry.totalCost) || 0), 0);
                const inspectedCount = sortedData.filter(entry => entry.inspectionStatus && entry.inspectionStatus !== 'Pending').length;
                
                // Process each record
                sortedData.forEach((entry, index) => {
                    // Build row data
                    const row = [
                        index + 1, // Row number
                        cleanText(entry.controlNumber || 'Not Assigned'),
                        cleanText(entry.timestamp || 'No Date'),
                        cleanText(entry.purchaseType || 'Not Specified'),
                        cleanText(entry.ucssSubTypes && entry.ucssSubTypes.length > 0 ? entry.ucssSubTypes.join('; ') : 'None'),
                        cleanText(entry.requestedBy || 'Not Provided'),
                        cleanText(entry.contactNumber || 'Not Provided'),
                        cleanText(entry.personalEmail || 'Not Provided'),
                        cleanText(entry.institutionalEmail || 'Not Provided'),
                        cleanText(entry.disbursingOfficer || 'Not Provided'),
                        cleanText(entry.officeDepartment || 'Not Provided'),
                        cleanText(entry.sectors && entry.sectors.length > 0 ? entry.sectors.join('; ') : 'None Selected'),
                        cleanText(entry.purpose || 'Not Provided'),
                        cleanText(entry.particulars || 'Not Provided'),
                        cleanText(entry.categories && entry.categories.length > 0 ? entry.categories.join('; ') : 'None Selected'),
                        cleanText(entry.othersText || 'N/A'),
                        parseFloat(entry.totalCost || 0).toFixed(2),
                        cleanText(entry.dateInspected || 'Not Inspected'),
                        cleanText(entry.timeInspected || 'Not Inspected'),
                        cleanText(entry.inspectedBy || 'Not Assigned'),
                        cleanText(entry.inspectionStatus || 'Pending Inspection'),
                        cleanText(entry.inspectionRemarks || 'No Remarks')
                    ];
                    
                    // Properly quote each field to prevent CSV parsing issues
                    csvRows.push(row.map(field => `"${field}"`).join(','));
                });
                
                // Create final CSV content
                const csvContent = BOM + csvRows.join('\r\n');
                
                // Create and download file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                const filename = `Complete_Database_${timestamp}.csv`;
                
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Cleanup
                setTimeout(() => URL.revokeObjectURL(url), 100);
                
                // Success notification
                alert(`‚úÖ Database Export Successful!\n\nüìÅ Filename: ${filename}\nüìä Total Records: ${sortedData.length}\nüí∞ Total Value: ‚Ç±${totalCost.toLocaleString()}\nüìà Completion Rate: ${sortedData.length > 0 ? ((inspectedCount / sortedData.length) * 100).toFixed(1) : 0}%\nüìÇ Saved to: Downloads folder`);
                
            } catch (error) {
                console.error('Export error:', error);
                alert(`‚ùå Export failed: ${error.message}\n\nPlease try again or contact technical support.`);
            }
        }

        function logoutAdmin() {
            if (confirm('üîê Are you sure you want to logout from admin panel?')) {
                sessionStorage.removeItem('adminLoggedIn');
                alert('üîê Admin logged out successfully.');
                // Hide current page and show page 2 (Inspection Request Form)
                document.getElementById('page1').classList.add('hidden');
                document.getElementById('page2').classList.remove('hidden');
                document.getElementById('page3').classList.add('hidden');
                document.getElementById('page4').classList.add('hidden');
            }
        }

        function deleteAllData() {
            // Double confirmation for safety
            const firstConfirm = confirm('‚ö†Ô∏è WARNING: This will permanently delete ALL inspection requests from the database!\n\nThis action cannot be undone. Are you sure you want to continue?');
            
            if (!firstConfirm) {
                return;
            }
            
            const secondConfirm = confirm('üö® FINAL CONFIRMATION: You are about to delete ALL data!\n\nType "DELETE ALL" in the next prompt to confirm this action.');
            
            if (!secondConfirm) {
                return;
            }
            
            const typeConfirm = prompt('Please type "DELETE ALL" (without quotes) to confirm deletion:');
            
            if (typeConfirm === 'DELETE ALL') {
                // Clear all data
                localStorage.removeItem('inspectionRequests');
                localStorage.removeItem('currentUserRequests');
                localStorage.removeItem('currentUserId');
                
                // Refresh the display
                displaySpreadsheet();
                
                alert('‚úÖ All inspection requests have been permanently deleted from the database!');
            } else {
                alert('‚ùå Deletion cancelled. Data remains safe.');
            }
        }

        function updateInspectionField(entryId, fieldName, value) {
            // Get current data
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const entryIndex = savedData.findIndex(entry => entry.id === entryId);
            
            if (entryIndex === -1) {
                alert('‚ùå Entry not found!');
                return;
            }
            
            // Update the field
            savedData[entryIndex][fieldName] = value;
            savedData[entryIndex].lastInspectionUpdate = new Date().toLocaleString();
            
            // Save back to localStorage
            localStorage.setItem('inspectionRequests', JSON.stringify(savedData));
            
            // Also update in current user data if it exists there
            const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
            const userEntryIndex = currentUserData.findIndex(entry => entry.id === entryId);
            if (userEntryIndex !== -1) {
                currentUserData[userEntryIndex][fieldName] = value;
                currentUserData[userEntryIndex].lastInspectionUpdate = new Date().toLocaleString();
                localStorage.setItem('currentUserRequests', JSON.stringify(currentUserData));
            }
            
            // Show brief success feedback
            const fieldLabels = {
                'dateInspected': 'Date Inspected',
                'timeInspected': 'Time Inspected',
                'inspectedBy': 'Inspector',
                'inspectionStatus': 'Status',
                'inspectionRemarks': 'Remarks'
            };
            
            // Create temporary success indicator
            const successIndicator = document.createElement('div');
            successIndicator.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm';
            successIndicator.innerHTML = `‚úÖ ${fieldLabels[fieldName]} updated!`;
            document.body.appendChild(successIndicator);
            
            // Remove after 2 seconds
            setTimeout(() => {
                if (document.body.contains(successIndicator)) {
                    document.body.removeChild(successIndicator);
                }
            }, 2000);
        }

        function deleteSpecificEntry(entryId) {
            // Get current data
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const entryToDelete = savedData.find(entry => entry.id === entryId);
            
            if (!entryToDelete) {
                alert('‚ùå Entry not found!');
                return;
            }
            
            // Show confirmation with entry details
            const confirmMessage = `‚ö†Ô∏è Are you sure you want to delete this inspection request?\n\n` +
                `üé´ Control Number: ${entryToDelete.controlNumber || 'Not Assigned'}\n` +
                `üë§ Requested By: ${entryToDelete.requestedBy}\n` +
                `üìÖ Date: ${entryToDelete.timestamp}\n` +
                `üí∞ Total Cost: ‚Ç±${entryToDelete.totalCost.toLocaleString()}\n\n` +
                `This action cannot be undone!`;
            
            if (confirm(confirmMessage)) {
                // Remove from main data
                const updatedData = savedData.filter(entry => entry.id !== entryId);
                localStorage.setItem('inspectionRequests', JSON.stringify(updatedData));
                
                // Also remove from current user data if it exists there
                const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
                const updatedUserData = currentUserData.filter(entry => entry.id !== entryId);
                localStorage.setItem('currentUserRequests', JSON.stringify(updatedUserData));
                
                // Refresh the display
                displaySpreadsheet();
                
                alert(`‚úÖ Inspection request deleted successfully!\nüé´ Control Number: ${entryToDelete.controlNumber || 'Not Assigned'}`);
            }
        }

        function printAllRequests(format) {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            
            if (savedData.length === 0) {
                alert('‚ùå No requests to print!');
                return;
            }

            // Sort by newest first
            const sortedData = savedData.sort((a, b) => b.id - a.id);
            
            let printContent;
            if (format === 'detailed') {
                printContent = createDetailedTableFormat(sortedData, 'All Inspection Requests');
            } else {
                printContent = createSummaryTableFormat(sortedData, 'All Inspection Requests - Summary');
            }
            
            // Create temporary print container
            const printContainer = document.createElement('div');
            printContainer.className = 'print-content';
            printContainer.innerHTML = printContent;
            printContainer.style.display = 'none';
            
            document.body.appendChild(printContainer);
            
            // Print
            window.print();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(printContainer);
            }, 1000);
        }

        function printSingleRequest(id) {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const requestToPrint = savedData.find(entry => entry.id === id);
            
            if (!requestToPrint) {
                alert('‚ùå Request not found!');
                return;
            }
            
            // Create print content showing the actual encoded data
            const printContent = createDetailedPrintFormat(requestToPrint);
            
            // Create temporary print container
            const printContainer = document.createElement('div');
            printContainer.className = 'print-content';
            printContainer.innerHTML = printContent;
            printContainer.style.display = 'none';
            
            document.body.appendChild(printContainer);
            
            // Print
            window.print();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(printContainer);
            }, 1000);
        }

        // Create detailed print format showing actual encoded data
        function createDetailedPrintFormat(entry) {
            const currentDate = new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Helper function to create checkbox
            function checkbox(isChecked) {
                return isChecked ? '‚òë' : '‚òê';
            }
            
            // Helper function to create filled line
            function filledLine(text, width = 200) {
                return `<span style="border-bottom: 1px solid #000; display: inline-block; min-width: ${width}px; padding-bottom: 2px;">${text || ''}</span>`;
            }
            
            return `
                <div class="print-header">
                    <h1 style="font-size: 24px; margin: 0; font-weight: bold; text-align: center;">INSPECTION REQUEST FORM</h1>
                    <h2 style="font-size: 16px; margin: 10px 0; color: #666; text-align: center;">Official Document</h2>
                    <div style="text-align: center; margin: 20px 0;">
                        <strong>Control Number: ${filledLine(entry.controlNumber || 'Not Assigned', 150)}</strong>
                    </div>
                    <p style="margin: 5px 0; font-size: 12px; text-align: center;">Printed on: ${currentDate}</p>
                </div>
                
                <div style="margin-bottom: 40px; font-size: 14px; line-height: 1.6;">
                    
                    <!-- Purchase Type Section -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">PURCHASE TYPE</h3>
                        
                        <div style="margin-bottom: 15px;">
                            <div style="margin-bottom: 8px;">
                                ${checkbox(entry.purchaseType === 'purchases')} UCSS Purchases
                            </div>
                            ${entry.purchaseType === 'purchases' ? `
                            <div style="margin-left: 30px; margin-bottom: 8px;">
                                ${checkbox(entry.ucssSubTypes && entry.ucssSubTypes.includes('external'))} External &nbsp;&nbsp;&nbsp;
                                ${checkbox(entry.ucssSubTypes && entry.ucssSubTypes.includes('internal'))} Internal &nbsp;&nbsp;&nbsp;
                                ${checkbox(entry.ucssSubTypes && entry.ucssSubTypes.includes('cashAdvance'))} Cash Advance
                            </div>
                            ` : ''}
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                ${checkbox(entry.purchaseType === 'postRepair')} Post Repair/Waste Material<br>
                                ${checkbox(entry.purchaseType === 'cashAdvanceMain')} Cash Advance<br>
                                ${checkbox(entry.purchaseType === 'internal')} Internal Funded
                            </div>
                            <div>
                                ${checkbox(entry.purchaseType === 'janitorial')} Janitorial Services<br>
                                ${checkbox(entry.purchaseType === 'external')} External Funded
                            </div>
                        </div>
                    </div>

                    <!-- Contact Information Section -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">CONTACT INFORMATION</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                            <div>
                                <strong>Contact Number:</strong><br>
                                ${filledLine(entry.contactNumber, 180)}
                            </div>
                            <div>
                                <strong>Personal Email:</strong><br>
                                ${filledLine(entry.personalEmail, 180)}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                            <div>
                                <strong>Institutional Webmail:</strong><br>
                                ${filledLine(entry.institutionalEmail, 180)}
                            </div>
                            <div>
                                <strong>Requested By:</strong><br>
                                ${filledLine(entry.requestedBy, 180)}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <strong>Name of Disbursing Officer:</strong><br>
                                ${filledLine(entry.disbursingOfficer, 180)}
                            </div>
                            <div>
                                <strong>Office and Department:</strong><br>
                                ${filledLine(entry.officeDepartment, 180)}
                            </div>
                        </div>
                    </div>

                    <!-- Sector Section -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">SECTOR</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                            ${['OP', 'OVPC', 'OVPred', 'OPVA', 'OVPAA', 'VPC', 'VPSS'].map(sector => 
                                `<div>${checkbox(entry.sectors && entry.sectors.includes(sector))} ${sector}</div>`
                            ).join('')}
                        </div>
                    </div>

                    <!-- Purpose and Particulars Section -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">PURPOSE & PARTICULARS</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                            <div>
                                <strong>Purpose:</strong><br>
                                <div style="border: 1px solid #000; padding: 8px; min-height: 60px; background-color: #f9f9f9;">
                                    ${entry.purpose || ''}
                                </div>
                            </div>
                            <div>
                                <strong>Particulars:</strong><br>
                                <div style="border: 1px solid #000; padding: 8px; min-height: 60px; background-color: #f9f9f9;">
                                    ${entry.particulars || ''}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Category Section -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">CATEGORY</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            ${checkbox(entry.categories && entry.categories.includes('salesInvoice'))} Sales Invoice/Official Receipt<br>
                            ${checkbox(entry.categories && entry.categories.includes('approvedPurchase'))} Approved Purchase Request<br>
                            ${checkbox(entry.categories && entry.categories.includes('proofSurrender'))} Proof or Surrender Waste<br>
                            ${checkbox(entry.categories && entry.categories.includes('specialOrder'))} Special Order/Line Item Budget<br>
                            ${checkbox(entry.categories && entry.categories.includes('postRepairInspection'))} Request for Post Repair Inspection<br>
                            ${checkbox(entry.categories && entry.categories.includes('inventoryCustodian'))} Inventory Custodian Receipt<br>
                            ${checkbox(entry.categories && entry.categories.includes('propertyAcknowledgement'))} Property Acknowledgement Receipt<br>
                            ${checkbox(entry.categories && entry.categories.includes('cnas'))} CNAS<br>
                            ${checkbox(entry.categories && entry.categories.includes('others'))} Others: ${entry.othersText ? filledLine(entry.othersText, 150) : filledLine('', 150)}
                        </div>
                    </div>

                    <!-- Total Cost Section -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">TOTAL COST</h3>
                        
                        <div style="text-align: center; font-size: 18px; font-weight: bold;">
                            ‚Ç±${entry.totalCost ? entry.totalCost.toLocaleString() : '0.00'}
                        </div>
                    </div>

                    <!-- Submission Details -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 16px; font-weight: bold; text-align: center; background-color: #f0f0f0; padding: 8px;">SUBMISSION DETAILS</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <strong>Date Submitted:</strong><br>
                                ${filledLine(entry.timestamp, 180)}
                            </div>
                            <div>
                                <strong>Status:</strong><br>
                                ${filledLine(entry.lastModified ? 'Modified' : 'Submitted', 180)}
                            </div>
                        </div>
                        
                        ${entry.lastModified ? `
                        <div style="margin-top: 15px;">
                            <strong>Last Modified:</strong><br>
                            ${filledLine(entry.lastModified, 300)}
                        </div>
                        ` : ''}
                    </div>

                </div>
                

            `;
        }

        function createDetailedTableFormat(data, title) {
            return `
                <div class="print-header">
                    <h1>${title}</h1>
                    <p>Generated on: ${new Date().toLocaleDateString()}</p>
                    <p>Total Records: ${data.length}</p>
                </div>
                
                <table class="print-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Control #</th>
                            <th>Date</th>
                            <th>Requested By</th>
                            <th>Purchase Type</th>
                            <th>Total Cost</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.map((entry, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${entry.controlNumber || 'N/A'}</td>
                                <td>${entry.timestamp}</td>
                                <td>${entry.requestedBy}</td>
                                <td>${entry.purchaseType}</td>
                                <td>‚Ç±${entry.totalCost.toLocaleString()}</td>
                                <td>${entry.lastModified ? 'Modified' : 'Submitted'}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function createSummaryTableFormat(data, title) {
            return `
                <div class="print-header">
                    <h1>${title}</h1>
                    <p>Generated on: ${new Date().toLocaleDateString()}</p>
                    <p>Total Records: ${data.length}</p>
                </div>
                
                <table class="print-table">
                    <thead>
                        <tr>
                            <th>Control #</th>
                            <th>Requested By</th>
                            <th>Date</th>
                            <th>Total Cost</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.map(entry => `
                            <tr>
                                <td>${entry.controlNumber || 'N/A'}</td>
                                <td>${entry.requestedBy}</td>
                                <td>${entry.timestamp}</td>
                                <td>‚Ç±${entry.totalCost.toLocaleString()}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function addFormControlButtons(entryId) {
            // Remove existing buttons if any
            const existingPrintButton = document.getElementById('printFormsButton');
            const existingCloseButton = document.getElementById('closeFormsButton');
            if (existingPrintButton) existingPrintButton.remove();
            if (existingCloseButton) existingCloseButton.remove();
            
            // Create button container
            const buttonContainer = document.createElement('div');
            buttonContainer.id = 'formControlButtons';
            buttonContainer.className = 'no-print';
            buttonContainer.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                display: flex;
                gap: 10px;
                flex-direction: column;
            `;
            
            // Create print button
            const printButton = document.createElement('div');
            printButton.id = 'printFormsButton';
            printButton.style.cssText = `
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                cursor: pointer;
                font-weight: bold;
                font-size: 16px;
                transition: all 0.3s ease;
                border: none;
                font-family: Arial, sans-serif;
                text-align: center;
            `;
            printButton.innerHTML = 'üñ®Ô∏è Print Forms';
            
            // Create close button
            const closeButton = document.createElement('div');
            closeButton.id = 'closeFormsButton';
            closeButton.style.cssText = `
                background: linear-gradient(135deg, #f44336, #d32f2f);
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                cursor: pointer;
                font-weight: bold;
                font-size: 16px;
                transition: all 0.3s ease;
                border: none;
                font-family: Arial, sans-serif;
                text-align: center;
            `;
            closeButton.innerHTML = '‚ùå Close Forms';
            
            // Add hover effects for print button
            printButton.onmouseover = function() {
                this.style.transform = 'scale(1.05)';
                this.style.boxShadow = '0 6px 20px rgba(0,0,0,0.4)';
            };
            printButton.onmouseout = function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '0 4px 15px rgba(0,0,0,0.3)';
            };
            
            // Add hover effects for close button
            closeButton.onmouseover = function() {
                this.style.transform = 'scale(1.05)';
                this.style.boxShadow = '0 6px 20px rgba(0,0,0,0.4)';
            };
            closeButton.onmouseout = function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '0 4px 15px rgba(0,0,0,0.3)';
            };
            
            // Add click handlers
            printButton.onclick = function() {
                printFilledForms(entryId);
            };
            
            closeButton.onclick = function() {
                hideFormDisplays(true);
            };
            
            // Add buttons to container
            buttonContainer.appendChild(printButton);
            buttonContainer.appendChild(closeButton);
            
            // Add to document
            document.body.appendChild(buttonContainer);
        }

        function hideFormDisplays(showMessage = false) {
            // Hide the form display container
            const formatDisplayContainer = document.getElementById('formatDisplayContainer');
            if (formatDisplayContainer) {
                formatDisplayContainer.classList.add('hidden');
            }
            
            // Remove control buttons
            const buttonContainer = document.getElementById('formControlButtons');
            if (buttonContainer) {
                buttonContainer.remove();
            }
            
            // Show success message only if requested
            if (showMessage) {
                const successMsg = document.createElement('div');
                successMsg.className = 'fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm';
                successMsg.innerHTML = '‚úÖ Forms hidden successfully!';
                document.body.appendChild(successMsg);
                
                setTimeout(() => {
                    if (document.body.contains(successMsg)) {
                        document.body.removeChild(successMsg);
                    }
                }, 2000);
            }
        }

        function printFilledForms(entryId) {
            // Find the entry data
            const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
            const entry = currentUserData.find(e => e.id === entryId);
            
            if (!entry) {
                alert('‚ùå Form data not found!');
                return;
            }
            
            // Get the current form display container
            const formatDisplayContainer = document.getElementById('formatDisplayContainer');
            if (!formatDisplayContainer || formatDisplayContainer.classList.contains('hidden')) {
                alert('‚ùå Please view the forms first before printing!');
                return;
            }
            
            // Create a clean copy of the forms for printing
            const printContent = createPrintableFormContent(formatDisplayContainer);
            
            // Create temporary print container
            const printContainer = document.createElement('div');
            printContainer.className = 'print-content';
            printContainer.innerHTML = printContent;
            printContainer.style.display = 'none';
            
            document.body.appendChild(printContainer);
            
            // Show loading message
            const printButton = document.getElementById('printFormsButton');
            const originalText = printButton.innerHTML;
            printButton.innerHTML = 'üñ®Ô∏è Preparing...';
            printButton.style.pointerEvents = 'none';
            
            // Print after a short delay to ensure content is ready
            setTimeout(() => {
                window.print();
                
                // Restore button
                printButton.innerHTML = originalText;
                printButton.style.pointerEvents = 'auto';
                
                // Clean up after print dialog closes and auto-hide forms
                setTimeout(() => {
                    if (document.body.contains(printContainer)) {
                        document.body.removeChild(printContainer);
                    }
                    // Auto-hide forms after printing
                    hideFormDisplays();
                }, 1000);
            }, 500);
        }

        function createPrintableFormContent(formatDisplayContainer) {
            // Get the current filled form data
            const currentUserData = JSON.parse(localStorage.getItem('currentUserRequests') || '[]');
            const entry = currentUserData[0]; // Get the most recent entry
            
            if (!entry) {
                return '<div>No form data found</div>';
            }
            
            // Create complete printable form content with all data filled
            const printContent = `
                <div class="format-display-container" style="background: white; padding: 20px;">
                    <div class="form-pages-wrapper" style="display: block;">
                        ${createPrintableFormCopy(entry, 1, 'IMO COPY')}
                        ${createPrintableFormCopy(entry, 2, 'SECOND COPY')}
                    </div>
                </div>
            `;
            
            // Add print-specific styles
            const printStyles = `
                <style>
                    @media print {
                        * {
                            -webkit-print-color-adjust: exact !important;
                            color-adjust: exact !important;
                        }
                        
                        body {
                            margin: 0;
                            padding: 0;
                            background: white !important;
                            font-family: 'Times New Roman', serif !important;
                            font-size: 10pt !important;
                        }
                        
                        .format-display-container {
                            background-color: white !important;
                            margin: 0 !important;
                            padding: 0 !important;
                            min-height: auto !important;
                            display: block !important;
                        }
                        
                        .form-pages-wrapper {
                            display: block !important;
                        }
                        
                        .form-container {
                            page-break-after: always;
                            margin: 0 auto 20px auto !important;
                            box-shadow: none !important;
                            border: 2px solid #000 !important;
                            width: 8.5in !important;
                            padding: 25px 30px !important;
                            box-sizing: border-box !important;
                            position: relative !important;
                            background: white !important;
                        }
                        
                        .form-container:last-child {
                            page-break-after: auto;
                            margin-bottom: 0 !important;
                        }
                        
                        .copy-label {
                            position: absolute !important;
                            top: 102px !important;
                            right: 30px !important;
                            font-size: 14px !important;
                            font-weight: bold !important;
                            padding: 6px 12px !important;
                            border-radius: 6px !important;
                            border: 2px solid !important;
                            font-family: Arial, sans-serif !important;
                        }
                        
                        .imo-copy {
                            color: #D32F2F !important;
                            background-color: #FFEBEE !important;
                            border-color: #D32F2F !important;
                        }
                        
                        .second-copy {
                            color: #388E3C !important;
                            background-color: #E8F5E8 !important;
                            border-color: #388E3C !important;
                        }
                        
                        .header-section {
                            display: flex !important;
                            align-items: flex-start !important;
                            margin-bottom: 15px !important;
                        }
                        
                        .logo {
                            width: 70px !important;
                            height: auto !important;
                            margin-right: 20px !important;
                            flex-shrink: 0 !important;
                        }
                        
                        .header-text {
                            flex-grow: 1 !important;
                            font-size: 11px !important;
                            line-height: 1.1 !important;
                            font-weight: bold !important;
                        }
                        
                        .control-info {
                            text-align: right !important;
                            font-size: 10px !important;
                            line-height: 1.1 !important;
                        }
                        
                        .control-no-line {
                            border-bottom: 1px solid #000 !important;
                            min-height: 18px !important;
                            margin-top: 2px !important;
                            width: 100% !important;
                            display: inline-block !important;
                            min-width: 120px !important;
                        }
                        
                        .form-title {
                            font-weight: bold !important;
                            font-size: 14px !important;
                            margin: 10px 0 15px 0 !important;
                            text-align: center !important;
                            text-decoration: underline !important;
                        }
                        
                        .checkbox-group {
                            display: flex !important;
                            flex-wrap: wrap !important;
                            margin-bottom: 15px !important;
                        }
                        
                        .checkbox-item {
                            display: flex !important;
                            align-items: center !important;
                            font-size: 11px !important;
                            width: 50% !important;
                            margin-bottom: 8px !important;
                        }
                        
                        .checkbox-item input[type="checkbox"] {
                            margin-right: 8px !important;
                            transform: scale(1.2) !important;
                        }
                        
                        .section-divider {
                            border-bottom: 1px solid #000 !important;
                            margin-bottom: 15px !important;
                        }
                        
                        .input-row {
                            display: flex !important;
                            align-items: baseline !important;
                            margin-bottom: 10px !important;
                        }
                        
                        .input-label {
                            font-size: 11px !important;
                            white-space: nowrap !important;
                            margin-right: 10px !important;
                            min-width: 150px !important;
                        }
                        
                        .input-field {
                            border-bottom: 1px solid #000 !important;
                            min-height: 18px !important;
                            width: 200px !important;
                            padding-bottom: 2px !important;
                            font-size: 10px !important;
                        }
                        
                        .documentary-requirements-title {
                            font-size: 11px !important;
                            font-weight: bold !important;
                            margin-bottom: 10px !important;
                        }
                        
                        .documentary-requirements-grid {
                            display: grid !important;
                            grid-template-columns: repeat(2, 1fr) !important;
                            gap: 10px 20px !important;
                        }
                        
                        .main-content-wrapper {
                            display: flex !important;
                            flex-direction: column !important;
                            gap: 20px !important;
                        }
                        
                        .top-section {
                            display: flex !important;
                            gap: 30px !important;
                        }
                        
                        .remarks-legend {
                            width: 100px !important;
                            font-size: 11px !important;
                        }
                        
                        .first-table-container {
                            flex-grow: 1 !important;
                        }
                        
                        .first-table-container table {
                            border-collapse: collapse !important;
                            width: 100% !important;
                            border: 1px solid black !important;
                        }
                        
                        .first-table-container th,
                        .first-table-container td {
                            border: 1px solid black !important;
                            padding: 6px !important;
                            text-align: center !important;
                            font-size: 10px !important;
                        }
                        
                        .first-table-container th {
                            background-color: #f2f2f2 !important;
                            font-weight: bold !important;
                        }
                        
                        .bottom-left-table-container {
                            width: 300px !important;
                        }
                        
                        .bottom-left-table-container table {
                            border-collapse: collapse !important;
                            width: 100% !important;
                            border: 1px solid black !important;
                        }
                        
                        .bottom-left-table-container td {
                            border: 1px solid black !important;
                            height: 25px !important;
                            padding: 5px !important;
                            font-size: 10px !important;
                        }
                        
                        .no-print {
                            display: none !important;
                        }
                    }
                    
                    @page {
                        size: A4;
                        margin: 0.5in;
                    }
                </style>
            `;
            
            return printStyles + printContent;
        }

        // Monitoring Report Functions
        function displayMonitoringReport() {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            
            // Set default date range (last 30 days)
            const today = new Date();
            const thirtyDaysAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);
            
            document.getElementById('reportFromDate').value = thirtyDaysAgo.toISOString().split('T')[0];
            document.getElementById('reportToDate').value = today.toISOString().split('T')[0];
            
            updateMonitoringReport();
        }

        function updateMonitoringReport() {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const fromDate = document.getElementById('reportFromDate').value;
            const toDate = document.getElementById('reportToDate').value;
            
            // Filter data by date range
            let filteredData = savedData;
            if (fromDate || toDate) {
                filteredData = savedData.filter(entry => {
                    const entryDate = new Date(entry.timestamp);
                    const from = fromDate ? new Date(fromDate) : null;
                    const to = toDate ? new Date(toDate + 'T23:59:59') : null;
                    
                    if (from && entryDate < from) return false;
                    if (to && entryDate > to) return false;
                    return true;
                });
            }
            
            // Update period display
            const reportPeriod = document.getElementById('reportPeriod');
            if (fromDate && toDate) {
                const fromFormatted = new Date(fromDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                const toFormatted = new Date(toDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                reportPeriod.textContent = `Period Covered: ${fromFormatted} - ${toFormatted}`;
            } else {
                reportPeriod.textContent = 'Period Covered: All Time';
            }
            
            // Populate table
            const tableBody = document.getElementById('monitoringTableBody');
            tableBody.innerHTML = filteredData.map((entry, index) => {
                const requestDate = new Date(entry.timestamp);
                const inspectedDate = entry.dateInspected ? new Date(entry.dateInspected) : null;
                const daysDiff = inspectedDate ? Math.ceil((inspectedDate - requestDate) / (1000 * 60 * 60 * 24)) : 'N/A';
                
                return `
                    <tr class="hover:bg-gray-50">
                        <td class="py-2 px-2 text-xs text-gray-900 text-center">${index + 1}</td>
                        <td class="py-2 px-2 text-xs text-blue-600 font-mono">${entry.controlNumber || 'N/A'}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.timestamp}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.dateInspected && entry.timeInspected ? `${entry.dateInspected} ${entry.timeInspected}` : 'Not Inspected'}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.requestedBy}</td>
                        <td class="py-2 px-2 text-xs text-gray-900" title="${entry.particulars}">${entry.particulars.length > 30 ? entry.particulars.substring(0, 30) + '...' : entry.particulars}</td>
                        <td class="py-2 px-2 text-xs text-green-600 font-semibold">‚Ç±${entry.totalCost.toLocaleString()}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.purchaseType}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.disbursingOfficer}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.sectors.join(', ')}</td>
                        <td class="py-2 px-2 text-xs text-gray-900" title="${entry.purpose}">${entry.purpose.length > 30 ? entry.purpose.substring(0, 30) + '...' : entry.purpose}</td>
                        <td class="py-2 px-2 text-xs text-gray-900">${entry.inspectedBy || 'Not Assigned'}</td>
                        <td class="py-2 px-2 text-xs">
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(entry.inspectionStatus)}">
                                ${entry.inspectionStatus || 'Pending'}
                            </span>
                        </td>
                        <td class="py-2 px-2 text-xs text-gray-900 text-center">${daysDiff}</td>
                    </tr>
                `;
            }).join('');
            

        }

        function getStatusColor(status) {
            switch (status) {
                case 'Complied':
                    return 'bg-green-100 text-green-800';
                case 'Not Complied':
                    return 'bg-red-100 text-red-800';
                case 'Pending':
                    return 'bg-yellow-100 text-yellow-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        function exportMonitoringReport() {
            const savedData = JSON.parse(localStorage.getItem('inspectionRequests') || '[]');
            const fromDate = document.getElementById('reportFromDate').value;
            const toDate = document.getElementById('reportToDate').value;
            
            // Filter data by date range
            let filteredData = savedData;
            if (fromDate || toDate) {
                filteredData = savedData.filter(entry => {
                    const entryDate = new Date(entry.timestamp);
                    const from = fromDate ? new Date(fromDate) : null;
                    const to = toDate ? new Date(toDate + 'T23:59:59') : null;
                    
                    if (from && entryDate < from) return false;
                    if (to && entryDate > to) return false;
                    return true;
                });
            }
            
            if (filteredData.length === 0) {
                alert('‚ùå No data to export for the selected period!');
                return;
            }

            try {
                // Enhanced text cleaning function for proper CSV formatting
                const cleanText = (text) => {
                    if (text === null || text === undefined) return '';
                    let cleaned = String(text).trim();
                    // Replace problematic characters
                    cleaned = cleaned.replace(/"/g, '""'); // Escape quotes by doubling them
                    cleaned = cleaned.replace(/[\r\n\t]/g, ' '); // Replace line breaks and tabs with spaces
                    cleaned = cleaned.replace(/,/g, ';'); // Replace commas with semicolons to prevent column breaks
                    cleaned = cleaned.replace(/\s+/g, ' '); // Replace multiple spaces with single space
                    return cleaned;
                };
                
                // Create CSV with UTF-8 BOM for Excel compatibility
                const BOM = '\uFEFF';
                const csvRows = [];
                
                // Official monitoring report header
                csvRows.push('""'); // Empty row
                csvRows.push('"OPERATIONS PURCHASE"');
                csvRows.push('"INSPECTION MONITORING REPORT"');
                csvRows.push('""'); // Empty row
                
                // Period information
                if (fromDate && toDate) {
                    const fromFormatted = new Date(fromDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                    const toFormatted = new Date(toDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                    csvRows.push(`"Period Covered: ${fromFormatted} - ${toFormatted}"`);
                } else {
                    csvRows.push('"Period Covered: All Time"');
                }
                csvRows.push(`"Report Generated: ${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })} at ${new Date().toLocaleTimeString()}"`);
                csvRows.push(`"Total Records: ${filteredData.length}"`);
                csvRows.push('""'); // Empty row
                
                // Official monitoring report column headers
                const headers = [
                    'No.', 'Control No.', 'Date and Time Requested', 'Date and Time Inspected',
                    'Name of Requester', 'Item Description', 'Cost (PHP)', 'Item Classification',
                    'Name of SDO', 'Unit/Sector', 'Purpose Project', 'Name of Inspector',
                    'Status', 'Number of Days', 'Remarks'
                ];
                csvRows.push(headers.map(h => `"${h}"`).join(','));
                
                // Sort data by newest first for consistent reporting
                const sortedData = [...filteredData].sort((a, b) => b.id - a.id);
                
                // Process each record for monitoring report
                sortedData.forEach((entry, index) => {
                    // Calculate processing days
                    let daysDiff = 'N/A';
                    if (entry.dateInspected && entry.timestamp) {
                        const requestDate = new Date(entry.timestamp);
                        const inspectedDate = new Date(entry.dateInspected);
                        if (!isNaN(requestDate.getTime()) && !isNaN(inspectedDate.getTime())) {
                            daysDiff = Math.ceil((inspectedDate - requestDate) / (1000 * 60 * 60 * 24));
                        }
                    }
                    
                    // Format inspection date and time
                    const inspectedDateTime = entry.dateInspected && entry.timeInspected 
                        ? `${new Date(entry.dateInspected).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })} ${entry.timeInspected}`
                        : 'Not Inspected';
                    
                    // Build monitoring report row
                    const row = [
                        index + 1, // Sequential number
                        cleanText(entry.controlNumber || 'Not Assigned'),
                        cleanText(entry.timestamp || 'No Date'),
                        cleanText(inspectedDateTime),
                        cleanText(entry.requestedBy || 'Not Provided'),
                        cleanText(entry.particulars || 'Not Provided'), // Item Description
                        parseFloat(entry.totalCost || 0).toFixed(2),
                        cleanText(entry.purchaseType || 'Not Specified'), // Item Classification
                        cleanText(entry.disbursingOfficer || 'Not Provided'), // Name of SDO
                        cleanText(entry.sectors && entry.sectors.length > 0 ? entry.sectors.join('; ') : 'Not Specified'), // Unit/Sector
                        cleanText(entry.purpose || 'Not Provided'), // Purpose Project
                        cleanText(entry.inspectedBy || 'Not Assigned'), // Name of Inspector
                        cleanText(entry.inspectionStatus || 'Pending'), // Status
                        daysDiff, // Number of Days
                        cleanText(entry.inspectionRemarks || 'No Remarks') // Remarks
                    ];
                    
                    // Properly quote each field for CSV
                    csvRows.push(row.map(field => `"${field}"`).join(','));
                });
                
                // Add monitoring report summary
                csvRows.push('""'); // Empty row
                csvRows.push('"MONITORING REPORT SUMMARY"');
                
                const totalCost = sortedData.reduce((sum, entry) => sum + (parseFloat(entry.totalCost) || 0), 0);
                const avgCost = sortedData.length > 0 ? totalCost / sortedData.length : 0;
                const inspectedCount = sortedData.filter(entry => entry.inspectionStatus && entry.inspectionStatus !== 'Pending').length;
                const compliedCount = sortedData.filter(entry => entry.inspectionStatus === 'Complied').length;
                const notCompliedCount = sortedData.filter(entry => entry.inspectionStatus === 'Not Complied').length;
                const pendingCount = sortedData.length - inspectedCount;
                
                // Calculate average processing time
                const processedEntries = sortedData.filter(entry => entry.dateInspected && entry.timestamp);
                let avgProcessingDays = 'N/A';
                if (processedEntries.length > 0) {
                    const totalDays = processedEntries.reduce((sum, entry) => {
                        const requestDate = new Date(entry.timestamp);
                        const inspectedDate = new Date(entry.dateInspected);
                        const days = Math.ceil((inspectedDate - requestDate) / (1000 * 60 * 60 * 24));
                        return sum + days;
                    }, 0);
                    avgProcessingDays = (totalDays / processedEntries.length).toFixed(1);
                }
                
                csvRows.push(`"Total Requests: ${sortedData.length}"`);
                csvRows.push(`"Total Cost: PHP ${totalCost.toFixed(2)}"`);
                csvRows.push(`"Average Cost: PHP ${avgCost.toFixed(2)}"`);
                csvRows.push(`"Inspected Requests: ${inspectedCount}"`);
                csvRows.push(`"Complied: ${compliedCount}"`);
                csvRows.push(`"Not Complied: ${notCompliedCount}"`);
                csvRows.push(`"Pending Inspection: ${pendingCount}"`);
                csvRows.push(`"Completion Rate: ${sortedData.length > 0 ? ((inspectedCount / sortedData.length) * 100).toFixed(1) : 0}%"`);
                csvRows.push(`"Compliance Rate: ${inspectedCount > 0 ? ((compliedCount / inspectedCount) * 100).toFixed(1) : 0}%"`);
                csvRows.push(`"Average Processing Time: ${avgProcessingDays} days"`);

                // Create final CSV content
                const csvContent = BOM + csvRows.join('\r\n');
                
                // Create and download file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                // Create official filename
                const dateRange = fromDate && toDate ? `${fromDate}_to_${toDate}` : 'all_time';
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                const filename = `Official_Operations_Purchase_Monitoring_Report_${dateRange}_${timestamp}.csv`;
                
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Cleanup
                setTimeout(() => URL.revokeObjectURL(url), 100);
                
                // Success notification with comprehensive details
                alert(`‚úÖ Official Monitoring Report Export Successful!\n\nüìÅ Filename: ${filename}\nüìä Total Records: ${sortedData.length}\nüí∞ Total Value: ‚Ç±${totalCost.toLocaleString()}\nüìÖ Period: ${fromDate && toDate ? `${fromDate} to ${toDate}` : 'All Time'}\nüìà Completion Rate: ${sortedData.length > 0 ? ((inspectedCount / sortedData.length) * 100).toFixed(1) : 0}%\n‚è±Ô∏è Avg Processing: ${avgProcessingDays} days\nüìÇ Saved to: Downloads folder\n\nüîß Excel Tips:\n‚Ä¢ File opens directly in Excel with proper formatting\n‚Ä¢ All data is in separate columns automatically\n‚Ä¢ Official monitoring report format\n‚Ä¢ Includes comprehensive summary statistics\n‚Ä¢ UTF-8 encoding preserves special characters\n\nüìã Report Contains:\n‚Ä¢ Complete inspection monitoring data\n‚Ä¢ Processing time analysis\n‚Ä¢ Compliance rate statistics\n‚Ä¢ Financial summaries\n‚Ä¢ Official PUP IMO format`);
                
            } catch (error) {
                console.error('Monitoring report export error:', error);
                alert(`‚ùå Monitoring report export failed: ${error.message}\n\nPlease try again or contact technical support.`);
            }
        }

        function createPrintableFormCopy(entry, copyNumber, copyLabel) {
            const copyClass = copyNumber === 1 ? 'imo-copy' : 'second-copy';
            
            return `
                <div class="form-container">
                    <span class="copy-label ${copyClass}">${copyLabel}</span>
                    
                    <div class="header-section">
                        <img src="https://www.pup.edu.ph/resources/images/logo200.png" alt="PUP Logo" class="logo" onerror="this.src='https://placehold.co/70x70/FFFFFF/000000?text=LOGO';">
                        <div class="header-text">
                            <p>Republic of the Philippines</p>
                            <p>Polytechnic University of the Philippines</p>
                            <p>OFFICE OF EXECUTIVE VICE PRESIDENT</p>
                            <p>Inspection Management Office</p>
                        </div>
                        <div class="control-info">
                            <p>PUP-RIOS-2-IMAO-003</p>
                            <p>Effectivity Date: June 18, 2025</p>
                            <p>Rev 1</p>
                            <p>Control No:<span class="control-no-line">${entry.controlNumber || ''}</span></p>
                        </div>
                    </div>

                    <div class="form-title">Request Form for Inspection of:</div>

                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" ${entry.purchaseType === 'purchases' ? 'checked' : ''}>
                            <label>Operations Purchase (Cash Advance, Internal Funded, External Funded)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" ${entry.purchaseType === 'postRepair' ? 'checked' : ''}>
                            <label>Post-Repair/Waste Material</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" ${entry.purchaseType === 'ucss' ? 'checked' : ''}>
                            <label>UCSS Purchase</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" ${entry.purchaseType === 'janitorial' ? 'checked' : ''}>
                            <label>Janitorial Services</label>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <div class="input-row">
                        <span class="input-label">Date and Time Requested:</span>
                        <div class="input-field">${entry.timestamp || ''}</div>
                        <span class="input-label" style="margin-left: 20px;">Requested by:</span>
                        <div class="input-field">${entry.requestedBy || ''}</div>
                    </div>
                    <div class="input-row">
                        <span class="input-label">Office/Department:</span>
                        <div class="input-field">${entry.officeDepartment || ''}</div>
                        <span class="input-label" style="margin-left: 20px;">Name of Disbursing Officer:</span>
                        <div class="input-field">${entry.disbursingOfficer || ''}</div>
                    </div>
                    <div class="input-row">
                        <span class="input-label">Purpose:</span>
                        <div class="input-field">${entry.purpose || ''}</div>
                        <span class="input-label" style="margin-left: 20px;">Particulars:</span>
                        <div class="input-field">${entry.particulars || ''}</div>
                    </div>

                    <div class="documentary-requirements">
                        <div class="documentary-requirements-title">Documentary Requirements: ( &#10003; or NA) <span style="font-style: italic; font-weight: normal; margin-left: 20px;">***** To be filled-out by Inspectors *****</span></div>
                        <div class="documentary-requirements-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('salesInvoice') ? 'checked' : ''}>
                                <label>Sales Invoice/Official Receipt</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('specialOrder') ? 'checked' : ''}>
                                <label>Special Order / Line-item budget</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('approvedPurchase') ? 'checked' : ''}>
                                <label>Approved Purchase Request</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('postRepairInspection') ? 'checked' : ''}>
                                <label>Request for Post-Repair and Inspection</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('proofSurrender') ? 'checked' : ''}>
                                <label>Proof of surrendered waste materials</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('inventoryCustodian') ? 'checked' : ''}>
                                <label>Inventory Custodian Slip</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('propertyAcknowledgement') ? 'checked' : ''}>
                                <label>Property Acknowledge Receipt</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('cnas') ? 'checked' : ''}>
                                <label>CNAS</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${entry.categories && entry.categories.includes('others') ? 'checked' : ''}>
                                <label>Others:</label>
                                <div class="input-field" style="margin-left: 10px; flex-grow: 1;">${entry.othersText || ''}</div>
                            </div>
                        </div>
                    </div>

                    <div class="main-content-wrapper">
                        <div class="top-section">
                            <div class="remarks-legend">
                                <p>Remarks:</p>
                                <p><b>C ‚Äì</b> <i>Complied</i></p>
                                <p><b>N.C ‚Äì</b> <i>Not Complied</i></p>
                            </div>

                            <div class="first-table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Document In<br>Date and Time</th>
                                            <th>Document Out<br>Date and Time</th>
                                            <th>Remarks</th>
                                            <th>C / N.C</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="height: 30px;"></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td style="height: 30px;"></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="bottom-left-table-container">
                            <table>
                                <tbody>
                                    <tr>
                                        <td style="height: 25px;"></td>
                                    </tr>
                                    <tr>
                                        <td style="height: 25px;"></td>
                                    </tr>
                                    <tr>
                                        <td style="height: 25px;"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d4cf7e6195fee1',t:'MTc1NDg4NDY2NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
